@model IOAS.Models.OrderModel
@using IOAS.GenericServices
@{
    ViewBag.Title = "Enhancement";
    Layout = "~/Views/Shared/_LayoutFluid.cshtml";
    <link href="@Url.Content("~/Content/IOASContent/assets/bootstrap-select/css/bootstrap-select.min.css")" rel="stylesheet" />
    string Remark = RequirementService.GetRejectCommitment(Model.ApplicationNo, Model.OrderID);
}
<style>
    .modal-dialog {
        width: 850px;
    }
     
    .rt-tb-scrl {
        width: 100%;
        height: 400px;
        overflow: auto;
    }

    .tbl-style table, .tbl-style tr, .tbl-style td, .tbl-style th {
        border: 1px solid #000;
    }

    .tbl-style > .table {
        margin-top: 10px;
        margin-bottom: 10px;
        width: 85% !important;
        max-width: 100% !important;
        margin-left: 60px;
    }

    .tbl-style > .table-bordered > thead > tr > th {
        border: 1px solid #000;
        border-width: 1px 1px 0px 1px !important;
        width: 100px;
    }

    .tbl-style > .table-bordered > tbody > tr > th {
        border: 1px solid #000;
        border-width: 1px 1px 0px 1px !important;
    }

    .tbl-style > .table-bordered > thead > tr > th {
        border-bottom-width: 0px;
    }

    .tbl-style > .table.table-bordered > tbody > tr > td {
        border: 1px solid #000;
        border-width: 1px 1px 0px 1px !important;
        width: 100px;
    }

    .reg-no {
        z-index: 1 !important;
    }
</style>
@using (Html.BeginForm("RecruitEnhancement", "Requirement", FormMethod.Post, new { @class = "", role = "form", @id = "formExtension", enctype = "multipart/form-data" }))
{
    <div class="row hd-tt-bg">
        <div class="col-md-12">
            <h4><b>Enhancement</b></h4>
        </div>
    </div>

    <div class="row">
        <div class="white-bg ad-navbar">
            <div class="col-md-2 ds-spl-bg">
            </div>
            <div class="col-md-3 ds-spl-bg">
                <div class="ds-icn">
                    <i class="ion-ios-list-outline "></i>
                </div>
                <div class="ds-tt">
                    @Html.HiddenFor(m => m.ApplicationID)
                    @Html.HiddenFor(m => m.OrderID)
                    @Html.HiddenFor(m => m.Status)
                    @Html.HiddenFor(m => m.ApplicationNo)
                    @Html.HiddenFor(m => m.TypeCode)
                    @Html.HiddenFor(m => m.isDADashboard)
                    @Html.HiddenFor(m => m.VendorId)
                    @Html.HiddenFor(M => M.StatutoryId)
                    @Html.HiddenFor(M => M.InitByPI_f)
                    <span>Request Reference</span>
                    @Html.DropDownListFor(m => m.RequestReference, new SelectList(ViewBag.ReferenceType, "id", "name"), "Select", new { @class = "form-control" })
                    <div>@Html.ValidationMessageFor(m => m.RequestReference)</div>
                </div>
            </div>
            <div class="col-md-3 ds-spl-bg">
                <div class="ds-icn">
                    <i class="ion-ios-list-outline "></i>
                </div>
                <div class="ds-tt" id="divRefNum">
                    <span class="required">Ref Number (WF / Tapal)</span>
                    @Html.TextBoxFor(M => M.ReferenceNo, new { @class = "form-control" })
                    @*@Html.TextBoxFor(m => m.SourceReferenceNumber, new { @class = "form-control dis-none" })
                        <div>@Html.ValidationMessageFor(M => M.SourceReferenceNumber)</div>*@
                    @Html.Hidden("SourceTapalOrWorkflow", "True")
                </div>
                <div class="dis-none ds-tt" id="divRefEmailDate">
                    <span class="required">Email Date</span>
                    @Html.EditorFor(m => m.SourceEmailDate, new { @class = "form-control" })
                    <div class="txt-error txt-red">@Html.ValidationMessageFor(m => m.SourceEmailDate)</div>
                </div>
            </div>
            <div class="col-md-4">
            </div>
        </div>
    </div>

    <div class="row cust-tab">
        <div class="page-wrapper mt30">
            <div>
                <div class="col-md-12">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="bl-lg-panel-box pb-null">
                                <div class="cmn-panel-box">
                                    <div class="row ">
                                        <div class="col-md-3">
                                            <div class="form-group custom-form-group">
                                                <label>Order Type</label><br />
                                                <h4>Extension / Enhancement</h4>
                                                @Html.HiddenFor(m => m.OrderType)
                                            </div>
                                        </div>
                                        @if (Model.ApplicationID > 0 && (Model.TypeCode == "STE" || Model.TypeCode == "OSG" || Model.TypeCode == "CON"))
                                        {
                                            <div class="col-md-3">
                                                <div class="form-group custom-form-group">
                                                    <label>Type of appointment </label>
                                                    <h4>@Model.Typeofappointment</h4>
                                                    @if (Model.TypeCode == "OSG")
                                                    {
                                                        @Html.DropDownListFor(m => m.TypeofappointmentId, new SelectList(ViewBag.Apptype, "id", "name"), "Select Appointment", new { @class = "form-control dis-none" })
                                                        @Html.DropDownListFor(m => m.PhysicallyChallenged, new SelectList(ViewBag.YesNo, "id", "name"), "Select", new { @class = "form-control dis-none", @id = "PhysicallyChallenged", @data_val = "false" })
                                                    }
                                                    else
                                                    {
                                                        @Html.HiddenFor(m => m.TypeofappointmentId)
                                                    }
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group custom-form-group">
                                                    @if (Model.OrderID == 0)
                                                    {
                                                        if (Model != null && Model.ConsolidatedPay)
                                                        {
                                                            @Html.RadioButtonFor(M => M.isConsolidatePay, "ConsolidatedPay", new { @id = "ConsolidatedPay", @checked = "checked" })@:&nbsp;<label>Consolidated pay</label><br>
                                                            @Html.RadioButtonFor(M => M.isConsolidatePay, "FellowshipPay", new { @id = "FellowshipPay" })@:&nbsp;<label>Fellowship</label>
                                                        }
                                                        else
                                                        {
                                                            @Html.RadioButtonFor(M => M.isConsolidatePay, "ConsolidatedPay", new { @id = "ConsolidatedPay" })@:&nbsp;<label>Consolidated pay</label><br>
                                                            @Html.RadioButtonFor(M => M.isConsolidatePay, "FellowshipPay", new { @id = "FellowshipPay", @checked = "checked" })@:&nbsp;<label>Fellowship</label>
                                                        }
                                                    }
                                                    else
                                                    {
                                                        if (Model != null && Model.isConsolidatePay == "ConsolidatedPay")
                                                        {
                                                            @Html.RadioButtonFor(M => M.isConsolidatePay, "ConsolidatedPay", new { @id = "ConsolidatedPay", @checked = "checked" })@:&nbsp;<label>Consolidated pay</label><br>
                                                            @Html.RadioButtonFor(M => M.isConsolidatePay, "FellowshipPay", new { @id = "FellowshipPay" })@:&nbsp;<label>Fellowship</label>
                                                        }
                                                        else
                                                        {
                                                            @Html.RadioButtonFor(M => M.isConsolidatePay, "ConsolidatedPay", new { @id = "ConsolidatedPay" })@:&nbsp;<label>Consolidated pay</label><br>
                                                            @Html.RadioButtonFor(M => M.isConsolidatePay, "FellowshipPay", new { @id = "FellowshipPay", @checked = "checked" })@:&nbsp;<label>Fellowship</label>
                                                        }
                                                    }
                                                </div>
                                            </div>
                                        }
                                        <div class="col-md-3">
                                            <div class="form-group custom-form-group  ">
                                                <label>Email ID</label>
                                                <h4>@Html.DisplayFor(m => m.Email)</h4>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row ">
                                    </div>

                                    <div class="row">
                                        <div class="col-md-3">
                                            <div class="form-group custom-form-group">
                                                <label>Name </label>
                                                <h4 id="CantidateName">@Html.DisplayFor(m => m.Name)</h4>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group custom-form-group mb-sm ">
                                                <label>Qualification</label>
                                                <h4>@Html.DisplayFor(m => m.Qualification)</h4>
                                            </div>
                                        </div>

                                        <div class="col-md-3">
                                            <div class="form-group custom-form-group  ">
                                                <label>Other experience</label>
                                                <h4>@Html.DisplayFor(m => m.Experience)</h4>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group custom-form-group  ">
                                                <label>Temporary Address  </label>
                                                <h4>@Model.PresentAddress</h4>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row ">
                                        <div class="col-md-3">
                                            <div class="form-group custom-form-group mb-sm ">
                                                <label>Employee Id</label>
                                                <h4>@Html.DisplayFor(m => m.EmployeeID)</h4>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group custom-form-group mb-sm ">
                                                <label>Contact No</label>
                                                <h4>@Html.DisplayFor(m => m.ContactNumber)</h4>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group custom-form-group ">
                                                <label>Date of Birth</label>
                                                <h4>@Html.DisplayFor(m => m.DateofBirth)</h4>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group custom-form-group ">
                                                <label>Age</label>
                                                <h4 id="Age">@Html.DisplayFor(m => m.Age)</h4>
                                            </div>
                                        </div>

                                    </div>
                                    <div class="row">
                                        <div class="col-md-3">
                                            <div class="form-group custom-form-group ">
                                                <label>Gate Score</label>
                                                <h4>@Html.DisplayFor(m => m.GateScore)</h4>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group custom-form-group ">
                                                <label>Application ReceiveDate</label>
                                                @Html.EditorFor(m => m.ApplicationReceiveDate, new { @class = "form-control ", @required = "required" })
                                                <div>@Html.ValidationMessageFor(m => m.ApplicationReceiveDate)</div>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group custom-form-group ">
                                                <label>IITM Experience</label>
                                                <h4>@Html.DisplayFor(m => m.IITMExperience)</h4>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group custom-form-group">
                                                <label class="required">PI Letter </label>
                                                @Html.HiddenFor(M => M.InitByPI_f)
                                                @if (Model.OrderID > 0 && !string.IsNullOrEmpty(Model.PILetterPath))
                                                {
                                                    <input type="file" id="PILetter" name="PILetter" style="width:300px;">
                                                    <h4>@Html.ActionLink(Model.PILetterFileName, "ShowDocument", new { Controller = "Account", filepath = "Requirement", file = Model.PILetterPath }, new { @name = "DocDownload", @target = "_blank" })</h4>
                                                    <div>@Html.ValidationMessage("PILetter")</div>
                                                }
                                                else if (Model.InitByPI_f == true)
                                                {
                                                    <input type="file" id="PILetter" name="PILetter">
                                                    <div>@Html.ValidationMessage("PILetter")</div>
                                                }
                                                else
                                                {
                                                    <input type="file" id="PILetter" name="PILetter" required style="width:300px;">
                                                    <div>@Html.ValidationMessage("PILetter")</div>
                                                }
                                            </div>
                                        </div>

                                    </div>
                                    <div class="row ">
                                        <div class="col-md-3">
                                            <div class="form-group custom-form-group mb-sm ">
                                                <label>Salary</label>
                                                <h4>@Html.DisplayFor(m => m.OldPrjDetailModel.Salary)</h4>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group custom-form-group mb-sm ">
                                                <label>Commitment amount</label>
                                                <h4>@Html.DisplayFor(m => m.OldPrjDetailModel.CommitmentAmmount)</h4>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="col-md-6">
                                                <div class="form-group custom-form-group">
                                                    <label>M.S/Ph.D</label>
                                                    <h4>@Html.CheckBoxFor(m => m.IsMsPhd, new { @Disabled = "Disabled" })</h4>
                                                </div>
                                            </div>
                                            @if (Model.IsMsPhd)
                                            {
                                                <div class="col-md-6">
                                                    <div class="form-group custom-form-group  ">
                                                        <label>Roll Number</label>
                                                        <h4>@Html.DisplayFor(m => m.PhdDetail)</h4>
                                                    </div>
                                                </div>
                                            }
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="bl-lg-panel-box  pb-null">
                                <div class="bl-lg-panel-box-hd mb-m-5 pd-null">
                                    <div class="cmn-panel-box">
                                        <div class="row">
                                            <div class="col-md-3">
                                                <div class="form-group custom-form-group mb-sm">
                                                    @Html.HiddenFor(m => m.OldPrjDetailModel.ProjectID)
                                                    <label>Project Number</label>
                                                    @if (Model.OrderID > 0)
                                                    {
                                                        @Html.TextBoxFor(m => m.ProjectNumber, new { @class = "form-control ", @required = "required" })
                                                        <div>@Html.ValidationMessageFor(m => m.ProjectNumber)</div>
                                                        @Html.HiddenFor(m => m.ProjectId)
                                                    }
                                                    else
                                                    {
                                                        @Html.TextBox("ProjectNumber", Model.OldPrjDetailModel.ProjectNumber, new { @class = "form-control ", @required = "required" })
                                                        <div>@Html.ValidationMessageFor(m => m.ProjectNumber)</div>
                                                        @Html.Hidden("ProjectId", Model.OldPrjDetailModel.ProjectID, new { @class = "required" })
                                                        <div>@Html.ValidationMessage("ProjectId")</div>
                                                    }
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group custom-form-group mb-sm">
                                                    <label>Project Title</label>
                                                    <h4 id="txtProjectTitle"></h4>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group custom-form-group mb-sm">
                                                    <label>Name of the Client / Sponsoring Agency</label>
                                                    <h4 id="txtClietAgency"></h4>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group custom-form-group mb-sm">
                                                    <label>Project Type</label>
                                                    <h4 id="txtProjectType"></h4>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-3">
                                                <div class="form-group custom-form-group mb-sm">
                                                    <label>PI Name</label>
                                                    <h4 id="txtPIName"></h4>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group custom-form-group mb-sm">
                                                    <label>Project Start Date</label>
                                                    <h4 id="txtProjectStartDate"></h4>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group custom-form-group mb-sm">
                                                    <label>Project Closure Date</label>
                                                    <h4 id="txtProjectClosureDate"></h4>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group custom-form-group mb-sm">
                                                    <label>PI Code</label>
                                                    <h4 id="txtPICode"></h4>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-3">
                                                <div class="form-group custom-form-group mb-sm">
                                                    <label>PI Email ID</label>
                                                    <h4 id="txtPIEmailID"></h4>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group custom-form-group mb-sm">
                                                    <label>PI Phone No</label>
                                                    <h4 id="txtPIPhone"></h4>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group custom-form-group mb-sm">
                                                    <label>Department code </label>
                                                    <h4 id="txtDepartmentCode"></h4>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group custom-form-group mb-sm">
                                                    <label>Department Name</label>
                                                    <h4 id="txtDepartmentName"></h4>
                                                </div>
                                            </div>
                                        </div>


                                        <div class="row">
                                            <div class="col-md-3">
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <div class="form-group custom-form-group">
                                                            <label>Appointment start date</label>
                                                            <h4 id="txtAppointmentStartDate">@Html.DisplayFor(m => m.OldPrjDetailModel.AppointmentStartDate)</h4>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <div class="form-group custom-form-group">
                                                            <label>Appointment End date</label>
                                                            <h4 id="txtAppointmentEndDate">@Html.DisplayFor(m => m.OldPrjDetailModel.AppointmentClosureDate)</h4>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group custom-form-group">
                                                    <label>Designation Code</label>
                                                    @Html.TextBoxFor(m => m.DesignationCode, new { @class = "form-control required", @autocomplete = "off" })
                                                    <div>@Html.ValidationMessageFor(m => m.DesignationCode)</div>
                                                    @if (!string.IsNullOrEmpty(Model.OtherDesignation)) 
                                                    {
                                                        <em style="color:red;font-size:15px;"><b>PI requested designation : @Html.DisplayFor(m => m.OtherDesignation)</b></em>
                                                    }
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group custom-form-group">
                                                    <label>Designation</label>
                                                    @if (Model.OrderID > 0)
                                                    {
                                                        @Html.TextBoxFor(m => m.Designation, new { @class = "form-control", @readonly = "readonly", @autocomplete = "off" })
                                                        <div>@Html.ValidationMessageFor(m => m.Designation)</div>
                                                        @Html.HiddenFor(m => m.DesignationId)
                                                    }
                                                    else
                                                    {
                                                        @Html.TextBox("Designation", Model.OldPrjDetailModel.Designation, new { @class = "form-control", @readonly = "readonly", @autocomplete = "off" })
                                                        <div>@Html.ValidationMessageFor(m => m.Designation)</div>
                                                        @Html.Hidden("DesignationId", Model.OldPrjDetailModel.DesignationId)
                                                    }
                                                    @Html.HiddenFor(m => m.OldPrjDetailModel.DesignationId, new { @id = "olddesignationid" })
                                                </div>
                                            </div>

                                            @if (Model.ApplicationID > 0 && Model.TypeCode == "STE")
                                            {
                                                <div class="col-md-3">
                                                    <div class="form-group custom-form-group">
                                                        <label>Medical</label> <br>
                                                        @Html.DropDownListFor(m => m.Medical, new SelectList(ViewBag.Medical, "id", "name"), "Select Medical", new { @class = "form-control", @data_val = "false" })
                                                        <h4 id="MedicalText" class="dis-none"></h4>
                                                        <div>@Html.ValidationMessageFor(m => m.Medical)</div>
                                                        @Html.HiddenFor(m => m.Medical, new { @id = "hdnMedical" })
                                                    </div>
                                                </div>
                                            }
                                        </div>

                                        <div class="row">
                                            <div class="col-md-3">
                                                <div class="form-group custom-form-group">
                                                    <label>Salary Level Range <i class="ion-information-circled" data-toggle="tooltip" data-original-title="" id="lblSalaryLevelDesription"></i></label>
                                                    <h4 id="lblSalaryLevel"></h4>
                                                    @Html.HiddenFor(m => m.SalaryLevelId)
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group custom-form-group">
                                                    <label>Salary</label>
                                                    @if (Model.OrderID > 0)
                                                    {
                                                        if (Model.TypeCode == "OSG")
                                                        {
                                                            @Html.TextBoxFor(m => m.Salary, new { @class = "form-control", @onkeypress = "return isNumberKey(event)", @autocomplete = "off", @onchange = "FillSalaryCalcDetls();" })
                                                        }
                                                        else
                                                        {
                                                            @Html.TextBoxFor(m => m.Salary, new { @class = "form-control", @onkeypress = "return isNumberKey(event)", @autocomplete = "off" })
                                                        }
                                                        <div>@Html.ValidationMessageFor(m => m.Salary)</div>
                                                    }
                                                    else
                                                    {
                                                        if (Model.TypeCode == "OSG")
                                                        {
                                                            @Html.TextBox("Salary", Model.OldPrjDetailModel.Salary, new { @class = "form-control", @onkeypress = "return isNumberKey(event)", @autocomplete = "off", @onchange = "FillSalaryCalcDetls();" })
                                                        }
                                                        else
                                                        {
                                                            @Html.TextBox("Salary", Model.OldPrjDetailModel.Salary, new { @class = "form-control", @onkeypress = "return isNumberKey(event)", @autocomplete = "off" })
                                                        }
                                                        <div>@Html.ValidationMessage("Salary")</div>
                                                    }
                                                    @Html.Hidden("MinSalary", 0)
                                                    @Html.Hidden("MaxSalary", 0)
                                                    @if (Model.TypeCode == "OSG")
                                                    {
                                                        <a href="#" class="bl-bg-txt" onclick="salarycalcpopup();">Salary Calculation</a>
                                                    }
                                                </div>
                                            </div>
                                            @if (Model.ApplicationID > 0 && Model.TypeCode == "STE")
                                            {
                                                <div class="col-md-3">
                                                    <div class="form-group custom-form-group">
                                                        <label>HRA</label>
                                                        <h4 id="HRAText"></h4>
                                                        @if (Model.OrderID > 0)
                                                        {
                                                            @Html.TextBoxFor(m => m.HRA, new { @class = "form-control", @onkeypress = "return isNumberKey(event)", @autocomplete = "off" })
                                                            <div>@Html.ValidationMessageFor(m => m.HRA)</div>
                                                        }
                                                        else
                                                        {
                                                            @Html.TextBox("HRA", Model.OldPrjDetailModel.HRA, new { @class = "form-control", @onkeypress = "return isNumberKey(event)", @autocomplete = "off" })
                                                            <div>@Html.ValidationMessage("HRA")</div>
                                                        }
                                                        @Html.HiddenFor(m => m.isHRA)
                                                        @Html.HiddenFor(m => m.HRAPercentage)
                                                    </div>
                                                </div>
                                                <div class="col-md-3" id="divMedicalAmmount">
                                                    <div class="form-group custom-form-group">
                                                        <label>Medical Amount</label>
                                                        @if (Model.OrderID > 0)
                                                        {
                                                            @Html.TextBoxFor(m => m.MedicalAmmount, new { @class = "form-control", @readonly = "readonly" })
                                                            <div>@Html.ValidationMessageFor(m => m.MedicalAmmount)</div>
                                                        }
                                                        else
                                                        {
                                                            @Html.TextBox("MedicalAmmount", Model.OldPrjDetailModel.MedicalAmmount, new { @class = "form-control", @readonly = "readonly" })
                                                            <div>@Html.ValidationMessage("MedicalAmmount")</div>
                                                        }
                                                        @Html.HiddenFor(m => m.isMedical)
                                                        @Html.Hidden("DesignationMedicalamount", 0)
                                                    </div>
                                                </div>
                                            }
                                            else if (Model.ApplicationID > 0 && Model.TypeCode == "CON")
                                            {
                                                <div class="col-md-3">
                                                    <div class="form-group custom-form-group">
                                                        <label>GST</label>
                                                        @if (Model.OrderID > 0)
                                                        {
                                                            @Html.TextBoxFor(m => m.GST, new { @class = "form-control", @onkeypress = "return isNumberKey(event)", @autocomplete = "off" })
                                                            <div>@Html.ValidationMessageFor(m => m.GST)</div>
                                                        }
                                                        else
                                                        {
                                                            @Html.TextBox("GST", Model.OldPrjDetailModel.GST, new { @class = "form-control", @onkeypress = "return isNumberKey(event)", @autocomplete = "off" })
                                                            <div>@Html.ValidationMessage("GST")</div>
                                                        }
                                                        @Html.Hidden("IsGSTapplicable")
                                                        @Html.Hidden("OldGST", Model.OldPrjDetailModel.GST)
                                                    </div>
                                                </div>
                                            }
                                            @if (Model.ApplicationID > 0 && Model.TypeCode == "OSG")
                                            {

                                                <div class="col-md-3" id="divMedicalAmmount">
                                                    <div class="form-group custom-form-group">
                                                        <label>Medical Amount</label>
                                                        @if (Model.OrderID > 0)
                                                        {
                                                            @Html.TextBoxFor(m => m.MedicalAmmount, new { @class = "form-control", @readonly = "readonly" })
                                                            <div>@Html.ValidationMessageFor(m => m.MedicalAmmount)</div>
                                                        }
                                                        else
                                                        {
                                                            @Html.TextBox("MedicalAmmount", Model.OldPrjDetailModel.MedicalAmmount, new { @class = "form-control", @readonly = "readonly" })
                                                            <div>@Html.ValidationMessage("MedicalAmmount")</div>
                                                        }
                                                        @Html.HiddenFor(m => m.isMedical)
                                                    </div>
                                                </div>
                                            }
                                            <div class="col-md-3 reg-no custom-reg-no">
                                                <div class="form-group custom-form-group">
                                                    <label class="">Commitment Amount</label>
                                                    @if (Model.OrderID > 0)
                                                    {
                                                        @Html.TextBoxFor(m => m.CommitmentAmount, new { @class = "form-control", @readonly = "readonly" })
                                                        <div>@Html.ValidationMessageFor(m => m.CommitmentAmount)</div>
                                                    }
                                                    else
                                                    {
                                                        @Html.TextBox("CommitmentAmount", 0, new { @class = "form-control", @readonly = "readonly" })
                                                        <div>@Html.ValidationMessage("CommitmentAmount")</div>
                                                    }
                                                    @Html.HiddenFor(m => m.OldPrjDetailModel.CommitmentAmmount, new { @id = "OldCommitmentAmmount" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-3">
                                                <div class="form-group custom-form-group">
                                                    <label class="required">Enhancement From Date</label>
                                                    <h4 id="txt-FromDate" class="">@Html.DisplayFor(m => m.OldPrjDetailModel.AppointmentClosureDate)</h4>
                                                    @Html.EditorFor(m => m.FromDate, new { @class = "form-control", @required = "required" })
                                                    <div>@Html.ValidationMessageFor(m => m.FromDate)</div>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group custom-form-group">
                                                    <label class="required">Enhancement To Date</label>
                                                    <h4 id="txt-ToDate">@Html.DisplayFor(m => m.OldPrjDetailModel.AppointmentClosureDate)</h4>
                                                    @Html.EditorFor(m => m.ToDate, new { @class = "form-control", @required = "required" })
                                                    <div>@Html.ValidationMessageFor(m => m.ToDate)</div>
                                                </div>
                                            </div>
                                            <div class="col-md-2 mt-mmd">
                                                <div class="form-group custom-form-group">
                                                    <input type="button" class="btn btn-success" value="View Staff Allocation" id="btnViewStaffAllocation">
                                                </div>
                                            </div>
                                            <div class="col-md-4 mt-mmd">
                                                <div class="form-group custom-form-group">
                                                    <input type="button" class="btn btn-success" value="Project Fund Availability" id="btnViewSummary">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-3">
                                                <div class="form-group custom-form-group">
                                                    <label class="required">Request received from PI</label>
                                                    @Html.TextBoxFor(m => m.AutoFillRequstedbyPI, new { @class = "form-control" })
                                                    @Html.HiddenFor(m => m.RequestedByPI)
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group custom-form-group">
                                                    <label>Arrear till</label>
                                                    @Html.EditorFor(m => m.ArrearOrDeductionTillDate, new { @class = "form-control" })
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group custom-form-group">
                                                    <label>Arrear Amount</label>
                                                    @Html.TextBoxFor(m => m.ArrearOrDeductionAmount, new { @class = "form-control", @readonly = "readonly" })
                                                </div>
                                            </div>
                                        </div>


                                        <div class="row">
                                            <div class="col-md-4">
                                                <label>PI Justification Document</label> <br>
                                                <div id="divPIJustification">
                                                    <input class="form-control mb-sm" id="PIJustificationFile_0" type="file" name="PIJustificationFile[0]" value="">
                                                    <a href="javascript:void(0)" class="btn-sm btn btn-danger mb-sm removeFile" style="margin-bottom: 10px;"><i class="ion-android-close"></i></a>
                                                </div>
                                                <a href="javascript:void(0)" id="btnAddFile" class="btn btn-success mt-20 mb20">Add New</a>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <label>PI Justification Remarks</label>
                                                    @Html.TextAreaFor(m => m.PIJustificationRemarks, new { @class = "form-control" })
                                                    <div>@Html.ValidationMessageFor(m => m.PIJustificationRemarks)</div>
                                                </div>
                                            </div>
                                            <div class="col-md-4 reg-no custom-reg-no">
                                                <div class="form-group">
                                                    <h4 class="mt-xs"></h4>
                                                    <h4 id="txt-WithdrawCommitment"></h4>
                                                    @Html.HiddenFor(m => m.isWithdrawCommitment)
                                                    @Html.HiddenFor(m => m.WithdrawalAmount)
                                                    <div>@Html.ValidationMessage("WithdrawalAmount")</div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <div class="row cust-tab" style="display:none;">
        <div class="page-wrapper mt30">
            <div>
                <div class="col-md-12">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="bl-lg-panel-box pb-null">
                                <div class="cmn-panel-box">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group custom-form-group">
                                                <label>Application No: </label>
                                                <h4>@Html.DisplayFor(m => m.ApplicationNo)</h4>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group custom-form-group">
                                                <label>Candidate Name: </label>
                                                <h4>@Html.DisplayFor(m => m.Name)</h4>
                                            </div>
                                        </div>
                                        @*<div class="col-md-6">
                                                <div class="form-group custom-form-group">
                                                    <label>PI Name:</label> <br>
                                                    <h4 id="ClPIName"></h4>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group custom-form-group">
                                                    <label>Department name:</label> <br>
                                                    <h4 id="ClDepartname"></h4>
                                                </div>
                                            </div>*@
                                        <div class="col-md-6">
                                            <div class="form-group custom-form-group">
                                                <label>MS/Phd:</label> <br>
                                                @if (Model.IsMsPhd == true)
                                                {
                                                    <h4>@Html.DisplayFor(m => m.PhdDetail)</h4>
                                                }
                                                else
                                                {
                                                    <h4>-</h4>
                                                }
                                            </div>
                                        </div>
                                        @*<div class="col-md-6">
                                                <div class="form-group custom-form-group">
                                                    <label>Designation: </label>
                                                    <h4 id="ClDesignation"></h4>
                                                </div>
                                            </div>*@
                                        <div class="col-md-6">
                                            <div class="form-group custom-form-group">
                                                <label>Qualification: </label>
                                                <h4>@Html.Raw(Model.Qualification)</h4>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group custom-form-group">
                                                <label>Experience: </label>
                                                <h4>@Html.DisplayFor(m => m.Experience)</h4>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group custom-form-group">
                                                <label>Pay: </label>
                                                <h4 id="lblPay"></h4>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group custom-form-group">
                                                <label>Medical:</label> <br>
                                                <h4 id="lblMedical"></h4>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group custom-form-group">
                                                <label>DOB </label>
                                                <h4>@Html.DisplayFor(m => m.DateofBirth)</h4>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group custom-form-group  ">
                                                <label>Application Received Date</label>
                                                <h4 id="ApplicationRevDate">@Html.DisplayFor(m => m.ApplicationReceiveDate)</h4>
                                            </div>
                                        </div>
                                        @if (Model.ApplicationID > 0 && Model.TypeCode == "STE" || Model.TypeCode == "OSG")
                                        {
                                            <div class="col-md-6">
                                                <div class="form-group custom-form-group">
                                                    @*<input id="ConsolidatedPay1" name="ClConsolidatedPay" type="checkbox" disabled> <span>Consolidated pay </span><br>
                                                        <input id="FellowshipPay1" name="ClFellowship" type="checkbox" disabled> <span>Fellowship</span> <br>*@
                                                    <label>Pay type</label>
                                                    <h4>@Html.DisplayFor(m => m.PayType)</h4>
                                                </div>
                                            </div>
                                        }
                                        <div class="col-md-6">
                                            <div class="form-group custom-form-group  mb-sm">
                                                <label>Staff Category</label>
                                                <h4>@Html.DisplayFor(m => m.staffcategory)</h4>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group custom-form-group ">
                                                <label>IITM Pensioner / CSIR Staff :</label>
                                                <h4>
                                                    @Html.DisplayFor(m => m.IITMPensionerCSIRStaff)
                                                </h4>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">

                                        <div class="col-md-6">
                                            <div class="form-group custom-form-group">
                                                <label>PI Justification Document</label> <br>
                                                @if (Model.OrderID > 0 && Model.JustificationDoc != null)
                                                {
                                                    foreach (var item in Model.JustificationDoc)
                                                    {
                                                        if (item.FilePath != null)
                                                        {
                                                            if (item.FilePath != "")
                                                            {
                                                                <h4>
                                                                    @Html.ActionLink(item.FileName, "ShowDocument", new { Controller = "Account", filepath = "Requirement", file = item.FilePath }, new { @name = "DocDownload", @target = "_blank" })

                                                                    @if (Model.Status == "Draft" || Model.Status == "Open" || Model.Status.Contains("Note"))
                                                                    {

                                                                        <a class="rct-del-doc" value="@item.FilePath">Delete</a>
                                                                    }
                                                                </h4><br>
                                                            }
                                                        }
                                                    }
                                                }
                                                <div id="fileAppend">
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-md-6">
                                            <div class="form-group custom-form-group  ">
                                                <label>Comments </label>
                                                @Html.TextAreaFor(m => m.Comments, new { @class = "form-control" })
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="bl-lg-panel-box  pb-null">
                                <div class="bl-lg-panel-box-hd mb-m-5 pd-null">
                                    <div class="cmn-panel-box">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-group custom-form-group mb-sm">
                                                    <label>Project Number</label>
                                                    <h4 id="txtProjectNumber"></h4>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group custom-form-group mb-sm">
                                                    <label>Project Title</label>
                                                    <h4 id="txtProjectTitle1"></h4>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-group custom-form-group mb-sm">
                                                    <label>Name of the Client / Sponsoring Agency</label>
                                                    <h4 id="txtClietAgency1"></h4>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group custom-form-group mb-sm">
                                                    <label>Project Type</label>
                                                    <h4 id="txtProjectType1"></h4>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-4">
                                                <div class="form-group custom-form-group mb-sm">
                                                    <label>PI Name</label>
                                                    <h4 id="txtPIName1"></h4>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group custom-form-group mb-sm">
                                                    <label>Project Start Date</label>
                                                    <h4 id="txtProjectStartDate1"></h4>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group custom-form-group mb-sm">
                                                    <label>Project Closure Date</label>
                                                    <h4 id="txtProjectClosureDate1"></h4>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-4">
                                                <div class="form-group custom-form-group mb-sm">
                                                    <label>PI Code</label>
                                                    <h4 id="txtPICode1"></h4>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group custom-form-group mb-sm">
                                                    <label>PI Email ID</label>
                                                    <h4 id="txtPIEmailID1"></h4>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group custom-form-group mb-sm">
                                                    <label>PI Phone No</label>
                                                    <h4 id="txtPIPhone1"></h4>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-4">
                                                <div class="form-group custom-form-group mb-sm">
                                                    <label>Department code </label>
                                                    <h4 id="txtDepartmentCode1"></h4>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group custom-form-group mb-sm">
                                                    <label>Department Name</label>
                                                    <h4 id="txtDepartmentName1"></h4>
                                                </div>
                                            </div>
                                            @if (Model.ApplicationID > 0 && Model.TypeCode == "STE" || Model.TypeCode == "OSG")
                                            {
                                                <div class="col-md-4">
                                                    <div class="form-group custom-form-group">
                                                        <label>Medical</label> <br>
                                                        <h4 id="txtMedical1"></h4>
                                                    </div>
                                                </div>
                                            }
                                        </div>
                                        <div class="row">
                                            <div class="col-md-4">
                                                <div class="form-group custom-form-group">
                                                    <label>Designation Code</label>
                                                    <h4 id="lblDesignationCode1"></h4>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group custom-form-group">
                                                    <label>Designation</label>
                                                    <h4 id="lblDesignationName1"></h4>
                                                </div>
                                            </div>

                                        </div>
                                        <div class="row">
                                            <div class="col-md-4">
                                                <div class="form-group custom-form-group">
                                                    <label>Appointment start date</label>
                                                    <h4 id="lblAppStartDate1"></h4>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group custom-form-group">
                                                    <label>Appointment End date</label>
                                                    <h4 id="lblAppEndDate1"></h4>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group custom-form-group">
                                                    <label>Commitment Amount</label>
                                                    <h4 id="lblCommitmentAmt1"></h4>
                                                </div>
                                            </div>

                                        </div>
                                        <div class="row">
                                            <div class="col-md-4">
                                                <div class="form-group custom-form-group">
                                                    <label>Committee member</label>
                                                    @Html.TextBoxFor(m => m.CommiteeMember1, new { @class = "form-control", @readonly = "readonly" })
                                                    @Html.HiddenFor(m => m.CommiteeMemberId1)
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group custom-form-group">
                                                    <label>Committee member</label>
                                                    @Html.TextBoxFor(m => m.CommiteeMember2, new { @class = "form-control", @readonly = "readonly" })
                                                    @Html.HiddenFor(m => m.CommiteeMemberId2)
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group custom-form-group">
                                                    <label> Chairperson</label>
                                                    @Html.TextBoxFor(m => m.ChairpersonName, new { @class = "form-control", @readonly = "readonly" })
                                                    @Html.HiddenFor(m => m.ChairpersonNameId)
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-group custom-form-group">
                                                    @Html.RadioButtonFor(m => m.FlowofMail, "NP", new { @id = "IsNotePI" }) <label class="ml-sm ">Send for PI Justification</label>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group custom-form-group">
                                                    @Html.RadioButtonFor(m => m.FlowofMail, "Nd", new { @id = "IsNodeviation" }) <label class="ml-sm ">No deviation</label>
                                                </div>
                                            </div>
                                            @if (Model.TypeCode == "OSG")
                                            {
                                                <div class="col-md-4">
                                                    <div class="form-group custom-form-group">
                                                        @Html.RadioButtonFor(m => m.SendSalaryStructure, "SST", new { @id = "IsSendSalaryStructure", @onclick = "checkuncheck(this)" }) <label class="ml-sm "> Send Pay Structure</label>
                                                    </div>
                                                </div>
                                            }
                                            @*<div class="col-md-6">
                                                    <div class="form-group custom-form-group">
                                                        @Html.RadioButtonFor(m => m.FlowofMail, "NDean", new { @id = "IsNotetoDean" })<label class="ml-sm ">Send for Dean's Approval</label>
                                                    </div>
                                                </div>*@

                                        </div>
                                        @*<div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group custom-form-group">
                                                        @Html.RadioButtonFor(m => m.FlowofMail, "NC", new { @id = "IsNotetoCommittee" })<label class="ml-sm ">Send for Commmittee Approval</label>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group custom-form-group">
                                                        @Html.RadioButtonFor(m => m.FlowofMail, "Nd", new { @id = "IsNodeviation" })<label class="ml-sm ">No deviation</label>
                                                    </div>
                                                </div>
                                            </div>*@
                                        <div id="Deviation">

                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                        </div>
                        <div class="col-md-6">
                            <div class="bl-lg-panel-box pb-null">
                                <div class="bl-lg-panel-box-hd mb-m-5 pd-null">
                                    <div class="cmn-panel-box">
                                        <div class="row">
                                            <div class="col-md-4" id="devCMAdmin">
                                                <div class="form-group custom-form-group">
                                                    @Html.RadioButtonFor(m => m.FlowApprover, "CMAdmin", new { @id = "IsNotetoCMAdmin" }) <label class="ml-sm ">Note to CM Admin</label>
                                                </div>
                                            </div>
                                            <div class="col-md-4" id="devNoteDean">
                                                <div class="form-group custom-form-group">
                                                    @Html.RadioButtonFor(m => m.FlowApprover, "NDean", new { @id = "IsNotetoDean" }) <label class="ml-sm " id="lblNoteDean">Note to Dean</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="text-center" style="margin-bottom: 50px;">
        <button type="button" class="btn btn-default" id="prevBtn" onclick="nextPrev(-1)">Previous</button>
        <button type="button" class="btn btn-primary" id="nextBtn" onclick="nextPrev(1)">Next</button>
        @Html.HiddenFor(m => m.List_f)
        @if (!string.IsNullOrEmpty(Model.List_f))
        {
            <button type="button" class="btn btn-default" onclick="window.location.href='@Url.Action(Model.List_f,"Requirement")';">Close</button>
        }
        else
        {
            <button type="button" class="btn btn-default" onclick="window.location.href='@Url.Action("EmployeeMaster","Requirement")';">Close</button>
        }
    </div>

    <div id="dialogConfirm" class="modal fade" role="dialog" data-backdrop="static" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header brd-bottom">
                    <button type="button" class="close" data-dismiss="modal">×</button>
                    <h4 class="modal-title">Mail Preview</h4>
                </div>
                <div class="modal-body">
                    <div style="padding:10px;margin-left: 10px;" id="divBcc">
                        <label>To mail</label>
                        <h4>@Html.DisplayFor(m => m.ToMail)</h4>
                        <label>Carbon Copy(CC)</label>
                        <h4>@Html.DisplayFor(m => m.CCMail)</h4>
                    </div>
                    <div style="padding:10px;overflow:auto" id="ShowDeviationND">
                    </div>
                    <div style="padding:10px;overflow:auto" id="ShowDeviationNP">
                    </div>
                </div>
                <div class="modal-footer brd-top">
                    <button type="button" class="btn btn-danger" id="isbtnConfirm">Confirm</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">No</button>
                </div>
            </div>
        </div>
    </div>

    <div id="salarycalc" class="modal fade modal-pr-vw" role="dialog">
        <div class="modal-dialog modal-lg">
            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <div class="row hd-tt-bg">
                        <div class="col-md-12">
                            <h4><b>Salary Calculation: </b></h4>
                        </div>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="page-wrapper">
                            <div class="custom-md-bg">
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="bl-lg-panel-box pb-null">
                                                    <div class="cmn-panel-box">
                                                        <div class="row ">
                                                            <div class="col-md-6">
                                                                <div class="form-group custom-form-group">
                                                                    @*@Html.RadioButtonFor(M => M.EmpType, "Existing Employee", new { @id = "IsExistingEmp", @checked = "checked" })&nbsp;<label>Existing Employee </label> <br>
                                                                        @Html.RadioButtonFor(M => M.EmpType, "New Employee", new { @id = "IsNewEmp" })&nbsp;<label>New Employee</label> <br>
                                                                        @Html.RadioButtonFor(M => M.EmpType, "Part time", new { @id = "IsParttime" })&nbsp;<label>Part time</label> <br>*@
                                                                    @*<input name="pay_norms2" type="radio" checked=""> Existing Employee <br>
                                                                        <input name="pay_norms2" type="radio"> New Employee <br>
                                                                        <input name="pay_norms2" type="radio"> Part time <br>
                                                                        <h4 id="lblEmplType" class="txt-bold"></h4>*@
                                                                    <label>Employee type: <span id="lblEmplType" class="txt-bold"></span>@Html.HiddenFor(m => m.EmpType, new { @class = "form-control" })</label>
                                                                    <label>Type of appointment: <span id="lblAppointType" class="txt-bold"></span></label>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <div class="form-group custom-form-group">
                                                                    <label>Recommended Salary</label>
                                                                    @Html.TextBoxFor(m => m.RecommendedSalary, new { @class = "form-control", @id = "RecommendSalary", @readonly = true })
                                                                    @*<input type="text" class="form-control">*@
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="row ">
                                                            <div class="col-md-6">
                                                                <div class="form-group custom-form-group">
                                                                    <label>Name </label>
                                                                    @Html.DropDownListFor(m => m.EmpSalutation, new SelectList(ViewBag.Professional, "id", "name"), "Select", new { @disabled = true })
                                                                    @Html.HiddenFor(m => m.EmpSalutation, new { @class = "form-control" })
                                                                    @Html.TextBoxFor(m => m.EmpName, new { @class = "form-control", @id = "EmpName", @readonly = true })
                                                                    @Html.HiddenFor(m => m.LWFAmount, new { @class = "form-control" })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <div class="form-group custom-form-group">
                                                                    <label>Designation</label> <br>
                                                                    @Html.TextBoxFor(m => m.EmpDesig, new { @class = "form-control", @id = "EmpDesig", @readonly = true })
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            @*<div class="col-md-6">
                                                                    <div class="form-group custom-form-group">
                                                                        <label>PH</label><br>
                                                                        @Html.RadioButtonFor(M => M.PhysicalyHandicaped, "Physically Handicapped", new { @id = "IsPH", @readonly = true })&nbsp;<label>Physically Handicapped</label> <br>
                                                                    </div>
                                                                </div>*@
                                                            <div class="col-md-6">
                                                                <div class="form-group custom-form-group mb-sm ">
                                                                    <label>PF Basic Wages</label>
                                                                    @Html.TextBoxFor(m => m.EmpPFBasicWages, new { @class = "form-control", @id = "EmpPFBasicWages" })
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="bl-lg-panel-box pb-null">
                                                    <div class="cmn-panel-box">
                                                        <div class="row">
                                                            <div class="col-md-12">
                                                                <h4>Deductions</h4>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-md-6">
                                                                <div class="form-group custom-form-group">
                                                                    <label>Employee PF</label>
                                                                    @Html.TextBoxFor(m => m.EmployeePF, new { @class = "form-control", @id = "EmployeePF", @readonly = true })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <div class="form-group custom-form-group">
                                                                    <label>Employee ESIC</label>
                                                                    @Html.TextBoxFor(m => m.EmployeeESIC, new { @class = "form-control", @id = "EmployeeESIC", @readonly = true })
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-md-6">
                                                                <div class="form-group custom-form-group">
                                                                    <label>Professional Tax</label>
                                                                    @Html.TextBoxFor(m => m.EmployeeProfessionalTax, new { @class = "form-control", @id = "EmployeeProfsnlTax" })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <div class="form-group custom-form-group">
                                                                    <label>Total Deduction</label>
                                                                    @Html.TextBoxFor(m => m.EmployeeTtlDeduct, new { @class = "form-control", @id = "EmployeeTtlDeduct", @readonly = true })
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-md-6">
                                                                <div class="form-group custom-form-group">
                                                                    <label>Net Salary</label>
                                                                    @Html.TextBoxFor(m => m.EmployeeNetSalary, new { @class = "form-control", @id = "EmployeeNetSalary", @readonly = true })
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="bl-lg-panel-box pb-null">
                                                    <div class="cmn-panel-box">
                                                        <div class="row">
                                                            <div class="col-md-12">
                                                                <h4>Contribution</h4>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-md-6">
                                                                <div class="form-group custom-form-group">
                                                                    <label>Employer PF</label>
                                                                    @Html.TextBoxFor(m => m.EmployerPF, new { @class = "form-control", @id = "EmployerPF", @readonly = true })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <div class="form-group custom-form-group">
                                                                    <label>
                                                                        Insurance
                                                                    </label>
                                                                    @Html.TextBoxFor(m => m.EmployerIns, new { @class = "form-control", @id = "EmployerIns" })
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-md-6">
                                                                <div class="form-group custom-form-group">
                                                                    <label>Employer ESIC</label>
                                                                    @Html.TextBoxFor(m => m.EmployerESIC, new { @class = "form-control", @id = "EmployerESIC", @readonly = true })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <div class="form-group custom-form-group">
                                                                    <label>Total Contribution</label>
                                                                    @Html.TextBoxFor(m => m.EmployerTtlContribute, new { @class = "form-control", @id = "EmployerttlContribute", @readonly = true })
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-md-6">
                                                                <div class="form-group custom-form-group">
                                                                    <label>Cost To Company(CTC) Per Month</label>
                                                                    @Html.TextBoxFor(m => m.EmployeeCTC, new { @class = "form-control", @id = "EmployeeCTC", @readonly = true })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <div class="form-group custom-form-group">
                                                                    <label>Agency Fee</label>
                                                                    @Html.TextBoxFor(m => m.AgencyFee, new { @class = "form-control", @id = "AgencyFee", @readonly = true })
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-md-6">
                                                                <div class="form-group custom-form-group">
                                                                    <label>CTC With Agency Fee</label>
                                                                    @Html.TextBoxFor(m => m.CTCwithAgencyFee, new { @class = "form-control", @id = "CTCwithAgencyFee", @readonly = true })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <div class="form-group custom-form-group">
                                                                    <label>GST</label>
                                                                    @Html.TextBoxFor(m => m.SalaryGST, new { @class = "form-control", @id = "SalaryGST", @readonly = true })
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-md-6">
                                                                <div class="form-group custom-form-group">
                                                                    <label><b>Total Cost per Month</b></label>
                                                                    @Html.TextBoxFor(m => m.TotalCTC, new { @class = "form-control", @id = "TotalCTC", @readonly = true })
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="btnSubmitSalaryCalc">Submit</button>
                </div>
            </div>
        </div>
    </div>

    <div id="dialogSalaryConfirm" class="modal fade scrl-table scrl-table-po-bl" role="dialog" data-backdrop="static" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header brd-bottom">
                    <button type="button" class="close" data-dismiss="modal">×</button>
                    <h4 class="modal-title">SALARY STRUCTURE</h4>
                </div>
                <div class="modal-body">
                    @*<div style="padding:10px;" id="divBcc">
                            <label>Carbon Copy(CC)</label>
                            <input name="bcc" type="text" class="form-control" id="bccList" />
                        </div>
                        <div style="padding:10px;overflow:auto" id="ShowDeviation">
                        </div>*@
                    <div class="tbl-style">
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th colspan="4" class="text-left">
                                        <center><h4><b>PAY STRUCTURE</b></h4></center>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="text-left">
                                        <b>Recommended Consolidated Salary</b>
                                    </td>
                                    <td class="text-left">
                                        @*@Model.RecommendedSalary*@
                                        <h4 id="lblRecommendedSalary" class="txt-bold"></h4>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-left">
                                        PF Basic wages
                                    </td>
                                    <td class="text-left">
                                        @*@Model.EmpPFBasicWages*@
                                        <h4 id="lblEmpPFBasicWages"></h4>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-left">
                                        <b>Gross Salary</b>
                                    </td>
                                    <td class="text-left">
                                        @*@Model.RecommendedSalary*@
                                        <h4 id="lblGrossSalary" class="txt-bold"></h4>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-left">
                                        Employee PF
                                    </td>
                                    <td class="text-left">
                                        @*@Model.EmployeePF*@
                                        <h4 id="lblEmployeePF"></h4>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-left">
                                        Employee ESIC (<span id="lblEmployeeESICPer">0.75</span>% of GP)
                                    </td>
                                    <td class="text-left">
                                        @*@Model.EmployeeESIC*@
                                        <h4 id="lblEmployeeESIC"></h4>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-left">
                                        Professional Tax
                                    </td>
                                    <td class="text-left">
                                        @*@Model.EmployeeProfessionalTax*@
                                        <h4 id="lblEmployeeProfessionalTax"></h4>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-left">
                                        <b>Total Deduction</b>
                                    </td>
                                    <td class="text-left">
                                        @*@Model.EmployeeTtlDeduct*@
                                        <h4 id="lblEmployeeTtlDeduct" class="txt-bold"></h4>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-left">
                                        <b>Net Salary</b>
                                    </td>
                                    <td class="text-left">
                                        @*@Model.EmployeeNetSalary*@
                                        <h4 id="lblEmployeeNetSalary" class="txt-bold"></h4>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-left">
                                        Employer PF
                                    </td>
                                    <td class="text-left">
                                        @*@Model.EmployerPF*@
                                        <h4 id="lblEmployerPF"></h4>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-left">
                                        Employer ESIC (<span id="lblEmployerESICPer">3.25</span>% of GP)
                                    </td>
                                    <td class="text-left">
                                        @*@Model.EmployerESIC*@
                                        <h4 id="lblEmployerESIC"></h4>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-left">
                                        Insurance
                                    </td>
                                    <td class="text-left">
                                        @*@Model.EmployerIns*@
                                        <h4 id="lblEmployerIns"></h4>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-left">
                                        <b>Total Employer Contribution</b>
                                    </td>
                                    <td class="text-left">
                                        @*@Model.EmployerTtlContribute*@
                                        <h4 id="lblEmployerTtlContribute" class="txt-bold"></h4>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-left">
                                        <b>Cost To Project (CTC) Per Month</b>
                                    </td>
                                    <td class="text-left">
                                        @*@Model.EmployeeCTC*@
                                        <h4 id="lblEmployeeCTC" class="txt-bold"></h4>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-left">
                                        ** Agency Fee (<span id="lblAgencyFeePer">1.94</span>%)
                                    </td>
                                    <td class="text-left">
                                        @*@Model.AgencyFee*@
                                        <h4 id="lblAgencyFee"></h4>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-left">
                                        CTC with Agency Fee
                                    </td>
                                    <td class="text-left">
                                        @*@Model.CTCwithAgencyFee*@
                                        <h4 id="lblCTCwithAgencyFee"></h4>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-left">
                                        ** GST @@ <span id="lblSalaryGSTPer">18</span>%
                                    </td>
                                    <td class="text-left">
                                        @*@Model.CTCwithAgencyFee*@
                                        <h4 id="lblSalaryGST"></h4>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-left">
                                        <b>Total cost / Per Month</b>
                                    </td>
                                    <td class="text-left">
                                        @*@Model.TotalCTC*@
                                        <h4 id="lblTotalCTC" class="txt-bold"></h4>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer brd-top">
                    <button type="button" class="btn btn-danger" id="issalaryConfirm">Confirm</button>
                    <button type="button" class="btn btn-default" id="issalaryClose">Close</button>
                </div>
            </div>
        </div>
    </div>

}

<div class="loading-bg dis-none">
</div>
<div id="popup">

</div>

<script>
    var errMsg = '@TempData["errMsg"]';
    var succMsg = '@TempData["succMsg"]';
    var alertMsg = '@TempData["alertMsg"]';
    var ApplicationID = @Html.Raw(Json.Encode(Model.ApplicationID)) || 0;
    var isMsPhd = @Html.Raw(Json.Encode(Model.IsMsPhd)) || false;
    var typcategory = @Html.Raw(Json.Encode(Model.TypeCode)) || "";
    var TypeOfAppointment = @Html.Raw(Json.Encode(Model.TypeofappointmentId)) ||0;
    var OrderID = @Html.Raw(Json.Encode(Model.OrderID))||0;
    var Medical = @Html.Raw(Json.Encode(Model.OldPrjDetailModel.Medical)) || 0;
    var Status = @Html.Raw(Json.Encode(Model.Status)) || "";

    var OldCommitmentAmmount = @Html.Raw(Json.Encode(Model.OldPrjDetailModel.CommitmentAmmount)) || 0;
    var OldSalary = @Html.Raw(Json.Encode(Model.OldPrjDetailModel.Salary)) || 0;
    var OldHRA = @Html.Raw(Json.Encode(Model.OldPrjDetailModel.HRA)) || 0;
    var OldProjectID = @Json.Encode(Model.OldPrjDetailModel.ProjectID) || 0;

    if(typcategory == "OSG")
        OldSalary = @Json.Encode(Model.OldTotalCTC) || 0;

    $(document).ready(function () {
        $('[data-toggle="tooltip"]').tooltip();

        $("#FromDate,#ToDate").datepicker({
            dateFormat: 'dd-MM-yy',
            showStatus: true,
            showWeeks: true,
            changeYear: true,
            yearRange: '1950:+30',
            highlightWeek: true,
            numberOfMonths: 1,
            showAnim: "scale",
            showOptions: {
                origin: ["top", "left"]
            }
        });

        $('#OrderType').val(2);

        var CommitmentRemark = @Html.Raw(Json.Encode(Remark)) || '';
        if (CommitmentRemark != '') {
            $('#alertSuccess').html(CommitmentRemark);
            $('#Success').modal('toggle');
        }

        if (succMsg != '') {
            $('#alertSuccess').html(succMsg);
            $('#Success').modal('toggle');
        }
        else if (errMsg != '') {
            $('#FailedAlert').html(errMsg);
            $('#Failed').modal('toggle');
        }
        else if (alertMsg != '') {
            $('#alert').html(alertMsg);
            $('#Validation').modal('toggle');
        }

        $('.selectpicker').selectpicker({
            liveSearch: true
        });
        $('.selectpicker').selectpicker('refresh');

        applyAutoComplete($('#ProjectNumber'), $('#ProjectId'), '@Url.Action("LoadProjectList","CoreAccounts")', 'ProjectSummary',true);

        applyAutoComplete($('#AutoFillRequstedbyPI'), $('#RequestedByPI'), '@Url.Action("LoadPIList", "Requirement")');

        $(document).on('keypress', 'input[id="DesignationCode"]', function () {
            var TypeId = 0;
            if(typcategory == "STE")
                TypeId = 2;
            else if(typcategory == "CON")
                TypeId = 1;
            else if(typcategory == "OSG")
                TypeId = 3;
            var checkvalue = $('input[name="isConsolidatePay"]:checked').val() == "ConsolidatedPay" ? true : false;
            if(typcategory == "CON")
                applyAutoCompleteDesignation($('#DesignationCode'), $('#DesignationId'),'@Url.Action("LoadDesignationConsultantList", "Requirement")?TypeCode=' + TypeId,'FillDesignation', true);
            else
                applyAutoCompleteDesignation($('#DesignationCode'), $('#DesignationId'),'@Url.Action("LoadDesignationList", "Requirement")?TypeCode=' + TypeId + '&isConsolidatePay='+checkvalue, 'FillDesignation', true);

        });

        //Set Max Min Dates
        var currentdate = moment(new Date()).toDate();
        if(OrderID > 0)
        {
            var appreceivedate = "@string.Format("{0:dd/MMMM/yyyy}", Model.ApplicationReceiveDate)";
            var appreceivedt   = moment(appreceivedate.split('-').join('/')).toDate();
            var sourceemaildate = "@string.Format("{0:dd/MMMM/yyyy}", Model.SourceEmailDate)";
            var sourceemaildt   = moment(sourceemaildate.split('-').join('/')).toDate();
            $('#ApplicationReceiveDate').datepicker({
                dateFormat: 'dd-MM-yy',
                changeYear: true
            }).datepicker("option", "maxDate", currentdate).datepicker("option", "minDate", appreceivedt);

            $('#SourceEmailDate').datepicker({
                dateFormat: 'dd-MM-yy',
                changeYear: true
            }).datepicker("option", "maxDate", currentdate).datepicker("option", "minDate", sourceemaildt);
        }
        else
        {
            $('#ApplicationReceiveDate,#SourceEmailDate').datepicker({
                dateFormat: 'dd-MM-yy',
                changeYear: true
            }).datepicker("option", "maxDate", currentdate).datepicker("option", "minDate", -185);
        }
        //$("#ToDate").addClass("dis-none");

        //FillSalaryCalcDetls();
        if(typcategory == "OSG")
        {
            //var emppfbasicwages = $('input[name=EmpPFBasicWages]').val() || 0;
            FillSalaryCalcDetls();
        }
    });

    function salarycalcpopup() {
        $('#salarycalc').modal('toggle');
    }

    var addyear = 0;

    if ($("#ProjectId").val() > 0)
        ProjectSummary();

    if ($("#DesignationId").val() > 0)
        FillDesignation()

    var flowApp = @Html.Raw(Json.Encode(Model.FlowApprover)) || "";

    if(flowApp == "CMAdmin")
    {
        $("input[name=FlowApprover][value=CMAdmin]").prop('checked', true);
        $("#devNoteDean").hide();
    }
    if(flowApp == "NDean")
    {
        $("input[name=FlowApprover][value=NDean]").prop('checked', true);
        $("#devCMAdmin").hide();
    }

    function FillDesignation() {
        var designationId = $('#DesignationId').val();
        if (designationId > 0) {
            $(".loading-bg").removeClass('dis-none');
            $.getJSON("@Url.Action("LoadDesignationDetails", "Requirement")", { DesignationID: designationId },
                    function (result) {
                        if (result.DesignationData.DestinationID > 0) {
                            $('#DesignationCode').val(result.DesignationData.DesignationCode);
                            $("#Designation").val(result.DesignationData.Designation);
                            $("#MinSalary").val(result.DesignationData.MinSalary);
                            $("#MaxSalary").val(result.DesignationData.MaxSalary);
                            $("#SalaryLevelId").val(result.DesignationData.SalaryLevelId);
                            $("#lblSalaryLevel").text(result.DesignationData.SalaryLevel);
                            $("#lblSalaryLevelDescription").attr("data-original-title",result.DesignationData.SalaryLevelDescription);
                            if (result.DesignationData.Medical == true && isMsPhd == false && TypeOfAppointment != 2) {

                                $('#isMedical').val(true)
                                $('#DesignationMedicalamount').val(result.DesignationData.MedicalAmount);
                                if (typcategory == "STE" && OrderID > 0)
                                    UpdateMedical(Medical);
                                else
                                    UpdateMedical(2);
                            }
                            else {
                                $('#isMedical').val(false)
                                $('#DesignationMedicalamount').val(0);
                                UpdateMedical(3);
                            }
                            $('#isHRA').val(result.DesignationData.HRA);
                            if (result.DesignationData.HRA == true && TypeOfAppointment != 2) {
                                $('#HRAText').addClass('dis-none');
                                $('#HRA').removeClass('dis-none');
                                $('#HRAPercentage').val(result.DesignationData.HRAPercentage)
                            }
                            else {
                                $('#HRAText').text('0');
                                $('#HRA,#HRAPercentage').val(0);
                                $('#HRAText').removeClass('dis-none');
                                $('#HRA').addClass('dis-none');
                            }
                            $(".loading-bg").addClass('dis-none');
                            UpdateDatepicker()
                        }
                        else
                            $(".loading-bg").addClass('dis-none');
                    });
        }
    }


    function UpdateDatepicker()
    {
        var ordId = $('#OrderID').val() || 0;
        var currentdate = moment(new Date()).toDate();
        var isprojectdiff = OldProjectID == $("#ProjectId").val() ? false : true;
        if(isprojectdiff)
        {
            var appointmentenddate = $('#txtAppointmentEndDate').text().split('-').join('/');
            var projectclousedate = $('#txtProjectClosureDate').text().split('-').join('/');
            var datepickerstartdate = moment(appointmentenddate).add(+1, 'days').toDate();
            var projectclosedate = moment(projectclousedate).toDate();

            var strdate = new Date(appointmentenddate);
            strdate = strdate.setDate(strdate.getDate() + 1,'days');
            strdate =  new Date(strdate);
            var formatdate = $.datepicker.formatDate('dd-MM-yy', strdate);

            $('#FromDate').datepicker({
                dateFormat: 'dd-MM-yy',
                changeYear: true
            }).datepicker("option", "minDate", datepickerstartdate).datepicker("option", "maxDate",projectclosedate);

            var datepickerenddate = moment(formatdate.split('-').join('/')).add(+1, 'years').add(-1, 'days').toDate();
            if(datepickerenddate > projectclosedate)
                datepickerenddate = projectclosedate;

            $('#ArrearOrDeductionTillDate').datepicker({
                dateFormat: 'dd-MM-yy',
                changeYear: true
            }).datepicker("option", "minDate", datepickerstartdate).datepicker("option", "maxDate", datepickerenddate);

            datepickerstartdate = moment(datepickerstartdate).add(+1, 'days').toDate();

            $('#ToDate').datepicker({
                dateFormat: 'dd-MM-yy',
                changeYear: true
            }).datepicker("option", "minDate", datepickerstartdate).datepicker("option", "maxDate", datepickerenddate);

            $('#FromDate').val(formatdate);
            if(ordId == 0)
                $('#ToDate').val("");
            $('#txt-FromDate').text(formatdate);
            $('#txt-FromDate').removeClass("dis-none");
            $('#FromDate').addClass("dis-none");
            $('#ToDate').removeClass("dis-none");
            $('#txt-ToDate').addClass("dis-none");
        }
        else
        {
            var appointmentstartdate = $('#txtAppointmentStartDate').text().split('-').join('/');
            var appointmentenddate = $('#txtAppointmentEndDate').text().split('-').join('/');
            var setappstrdat = moment(appointmentstartdate).toDate();
            var setappenddt = moment(appointmentenddate).toDate();
            var datepickerenddate = moment(appointmentenddate).toDate();
            var designationId = $('#DesignationId').val();

            if(designationId != $('#olddesignationid').val())
                datepickerenddate = moment(datepickerenddate).add(+1, 'days').toDate();
            if(ordId == 0) {
                if(currentdate != '' && setappstrdat != '') {
                    if(setappstrdat <= currentdate)
                    {
                        //setappstrdat = moment(new Date()).add(-currentdate.getDate(), 'days').add(+1,'days').toDate();
                         var BeginDate = moment(new Date()).add(-currentdate.getDate(), 'days').add(+1,'days').toDate();
                        if( setappstrdat <= BeginDate && BeginDate <= setappenddt)
                            setappstrdat = BeginDate;
                    }
                }
            }

            if(ordId > 0)
            {

                var fromdt = $('#FromDate').val();
                var todt = $('#ToDate').val();
                $('#txt-FromDate').addClass("dis-none");
                $('#FromDate').removeClass("dis-none");
                $('#ToDate').addClass("dis-none");
                $('#txt-ToDate').removeClass("dis-none");
                if (fromdt != "" && todt != "")
                {
                    fromdt = fromdt.split('-').join('/');
                    todt = todt.split('-').join('/');
                    /*Changes done by Madhu for bug Id 7160
                     * var momentfromdt = moment(fromdt).toDate();*/
                    var momentfromdt = moment(new Date()).add(-currentdate.getDate(), 'days').add(+1, 'days').toDate();
                    var momenttodt = moment(todt).toDate();
                    if(setappstrdat <= momentfromdt && momenttodt <= setappenddt)
                    {
                        $('#FromDate').datepicker({
                            dateFormat: 'dd-MM-yy',
                            changeYear: true
                        }).datepicker("option", "minDate", momentfromdt).datepicker("option", "maxDate",datepickerenddate);

                        $('#ToDate').datepicker({
                            dateFormat: 'dd-MM-yy',
                            changeYear: true
                        }).datepicker("option", "maxDate", setappenddt);
                    }
                    else
                    {
                        var addfromdt = moment(fromdt).toDate();
                        var projectclousedate = $('#txtProjectClosureDate').text().split('-').join('/');
                        var startDateDateaddyear = moment(fromdt).add(+1, 'years').add(-1, 'days').toDate();
                        var projectenddate = moment(projectclousedate).toDate();

                        if(startDateDateaddyear > projectenddate) {
                            startDateDateaddyear = projectenddate;
                        }
                        $('#FromDate').datepicker({
                            dateFormat: 'dd-MM-yy',
                            changeYear: true
                        }).datepicker("option", "minDate", addfromdt).datepicker("option", "maxDate",startDateDateaddyear);

                        var addtofromdt = moment(fromdt).add(+1, 'days').toDate();
                        var startDatetoDateaddyear = moment(startDateDateaddyear).add(+1, 'days').toDate();
                        $('#ToDate').datepicker({
                            dateFormat: 'dd-MM-yy',
                            changeYear: true
                        }).datepicker("option", "minDate", addtofromdt).datepicker("option", "maxDate", startDatetoDateaddyear);
                        $('#ToDate').removeClass("dis-none");
                        $('#txt-ToDate').addClass("dis-none");
                        //$('#ToDate').val('');

                        //$('#FromDate').datepicker({
                        //    dateFormat: 'dd-MM-yy',
                        //    changeYear: true
                        //}).datepicker("option", "minDate", setappstrdat).datepicker("option", "maxDate",datepickerenddate);

                        //$('#ToDate').datepicker({
                        //    dateFormat: 'dd-MM-yy',
                        //    changeYear: true
                        //}).datepicker("option", "maxDate", setappenddt);
                    }
                }
            }
            else
            {
                $('#FromDate').datepicker({
                    dateFormat: 'dd-MM-yy',
                    changeYear: true
                }).datepicker("option", "minDate", setappstrdat).datepicker("option", "maxDate",datepickerenddate);

                $('#ArrearOrDeductionTillDate').datepicker({
                    dateFormat: 'dd-MM-yy',
                    changeYear: true
                }).datepicker("option", "minDate", setappstrdat).datepicker("option", "maxDate", setappenddt);


                $('#ToDate').datepicker({
                    dateFormat: 'dd-MM-yy',
                    changeYear: true
                }).datepicker("option", "maxDate", setappenddt);

                $('#txt-FromDate').addClass("dis-none");
                $('#FromDate').removeClass("dis-none");
                $('#ToDate').addClass("dis-none");
                $('#txt-ToDate').removeClass("dis-none");

                if ($('#txtAppointmentEndDate').text() != "") {
                    $('#ToDate').val($('#txtAppointmentEndDate').text());
                }
            }

        }
    }

    function ProjectSummary() {
        var projectId = $("#ProjectId").val();
        if (projectId != "" || projectId != 0) {
            $(".loading-bg").removeClass('dis-none');
            $.getJSON("@Url.Action("LoadProjectDetails", "Requirement")", { ProjectId: projectId },
             function (result) {
                 if (result.projectData.ProjectNumber != null) {
                     $('#txtProjectTitle,#txtProjectTitle1').text(result.projectData.ProjectTitle);
                     $('#txtClietAgency,#txtClietAgency1').text(result.projectData.SponsoringAgency);
                     $('#txtProjectType,#txtProjectType1').text(result.projectData.ProjectType);
                     $('#txtPIName,#txtPIName1,#ClPIName').text(result.projectData.PIName);
                     $('#txtProjectStartDate,#txtProjectStartDate1').text(result.projectData.ProjectStartDate);
                     $('#txtProjectClosureDate,#txtProjectClosureDate1').text(result.projectData.ProjectClosureDate);
                     FillPIDetails(result);
                     UpdateDatepicker()
                     $(".loading-bg").addClass('dis-none');
                 }
                 else {
                     $(".loading-bg").addClass('dis-none');
                 }
             });
        }
    }

    function FillPIDetails(result) {
        if (result.projectData.ProjectNumber != null) {
            $('#txtPICode,#txtPICode1').text(result.projectData.PICode);
            $('#txtPIEmailID,#txtPIEmailID1').text(result.projectData.Email);
            $('#txtPIPhone,#txtPIPhone1').text(result.projectData.Phone);
            $('#txtDepartmentCode,#txtDepartmentCode1').text(result.projectData.PIDepartmentCode);
            $('#txtDepartmentName,#txtDepartmentName1,#ClDepartname').text(result.projectData.PIDepartmentName);
            if($('#AutoFillRequstedbyPI').val() == "") {
                $('#AutoFillRequstedbyPI').val(result.projectData.PIName);
                $('#RequestedByPI').val(result.projectData.PIId);
            }
        }
    }


    $('#Salary').keyup(function () {
        if(typcategory == "OSG")
            FillSalaryCalcDetls();
        else {
            calculatetaxTotal();
            if($('#ArrearOrDeductionTillDate').val() != "") {
                var Arrearamount = calculatetaxTotal(true) || 0;
                $('#ArrearOrDeductionAmount').val(Math.round(Arrearamount));
            }
        }
    });
    $('#HRA').change(function () {
        calculatetaxTotal();
        if($('#ArrearOrDeductionTillDate').val() != "") {
            var Arrearamount = calculatetaxTotal(true) || 0;
            $('#ArrearOrDeductionAmount').val(Math.round(Arrearamount));
        }
    });

    $("#ArrearOrDeductionTillDate").change(function () {

        if(typcategory == "OSG")
            FillSalaryCalcDetls();
        else
        {
            var Arrearamount = calculatetaxTotal(true) || 0;
            $('#ArrearOrDeductionAmount').val(Math.round(Arrearamount));
        }
    });

    $('#EmployeeProfsnlTax').change(function () {
        var salary = $('#Salary').val();
        if(salary > 0)
        {
            //var emppfbasicwages = $('input[name=EmpPFBasicWages]').val() || 0;
            FillSalaryCalcDetls();
            //calculatetaxTotal();
        }
    });

    $('#EmployerIns').change(function () {
        var salary = $('#Salary').val();
        if(salary > 0)
        {
            //var emppfbasicwages = $('input[name=EmpPFBasicWages]').val() || 0;
            FillSalaryCalcDetls();
            //calculatetaxTotal();
        }
    });

    //$('#EmployeeProfsnlTax').change(function () {
    //    FillSalaryCalcDetls();
    //    calculatetaxTotal();
    //});
    //$('#EmployerIns').change(function () {
    //    FillSalaryCalcDetls();
    //    calculatetaxTotal();
    //});
    //$('#Salary').change(function () {
    //    if(typcategory == "OSG")
    //        FillSalaryCalcDetls();
    //    calculatetaxTotal();
    //});

    $('input[name=EmpPFBasicWages]').keyup(function () {
        //var emppfbasicwages = $('input[name=EmpPFBasicWages]').val();
        FillSalaryCalcDetls();
        //calculatetaxTotal();
    });

    //$('input[name=RecommendedSalary]').change(function () {
    //    FillSalaryCalcDetls();
    //});
    //$('select[name=PhysicallyChallenged]').change(function () {
    //    FillSalaryCalcDetls();
    //});
    $('#btnSubmitSalaryCalc').click(function () {
        PopupSalaryConfirm();
    });
    $('#issalaryConfirm').click(function () {
        $('#dialogSalaryConfirm').modal('toggle');
    });
    $('#issalaryClose').click(function () {
        $('#dialogSalaryConfirm').modal('toggle');
    });
    function PopupConfirm() {
        $('#dialogConfirm').modal('toggle');
    }
    function PopupSalaryConfirm() {
        $('#dialogSalaryConfirm').modal('toggle');
        $('#salarycalc').modal('toggle');
    }


    function calculatetaxTotal(isarrearpay)
    {
        if(typcategory == "STE")
        {
            if ($('#FromDate').val() != "" && $('#ToDate').val() != "") {
                var startdate = new Date($('#FromDate').val().split('-').join('/'));
                var enddate = new Date($('#ToDate').val().split('-').join('/'));
                if(isarrearpay == true) {
                    enddate = new Date($('#ArrearOrDeductionTillDate').val().split('-').join('/'));
                }
                var count = monthCount(startdate,enddate);
                //define moments for the startdate and enddate
                var StartDateTotalDays = parseInt(endOfMonth(startdate).getDate());
                var EndDateTotalDays = parseInt(endOfMonth(enddate).getDate());
                var StartWorkingDays =0;
                var EndWorkingDays=0;
                if(startdate.getMonth() == enddate.getMonth() && startdate.getFullYear() == enddate.getFullYear()) {
                    StartWorkingDays = parseInt(enddate.getDate()) - parseInt(startdate.getDate())+1;
                }
                else {
                    StartWorkingDays = StartDateTotalDays - parseInt(startdate.getDate()) + 1;
                    EndWorkingDays = enddate.getDate();
                }

                var months =count || 0;
                var days = StartWorkingDays + EndWorkingDays;
                var HRAValue = 0;
                var ttlVal = 0;
                var MedicalAmount = 0;
                var Salary = parseFloat($('#Salary').val()) || 0;
                var HRA = parseFloat($("#HRA").val()) || 0;
                var SalaryDiff = 0,HRADiff = 0,CommitmentDiff = 0;
                //If Check enhancement within tenure or out
                var AppointmentStartdt=new Date('@string.Join("/",Model.OldPrjDetailModel.AppointmentStartDate.Split('-'))');
                var AppointmentClosedt=new Date('@string.Join("/",Model.OldPrjDetailModel.AppointmentClosureDate.Split('-'))');

                if ((startdate >= AppointmentStartdt && enddate <= AppointmentClosedt)) {
                    SalaryDiff = Salary - OldSalary;
                    if (getBoolean($('#isHRA').val()) == true  && HRA > 0) {
                        var HRAPer = parseFloat($("#HRAPercentage").val()) || 0;
                        HRAPer = HRAPer / 100;
                        HRAValue = Salary * HRAPer;
                        if(HRAValue < HRA || HRAValue > HRA)
                            $("#HRA").val(HRAValue.toFixed(2));
                    }
                    else {
                        HRAValue = 0;
                        $("#HRA").val(0);
                    }
                    HRAValue = HRAValue - OldHRA;
                }
                else {
                    if(HRA > 0) {
                        var HRAPer = parseFloat($("#HRAPercentage").val()) || 0;
                        HRAPer = HRAPer / 100;
                        if (getBoolean($('#isHRA').val()) == true) {
                            HRAValue = Salary * HRAPer;
                            if(HRAValue < HRA || HRAValue > HRA)
                                $("#HRA").val(HRAValue.toFixed(2));
                        }
                        else {
                            HRAValue = 0;
                            $("#HRA").val(0);
                        }
                    }
                    SalaryDiff = Salary;
                }
                var Tot = 0;
                if (isMsPhd || TypeOfAppointment == 2) {
                    MedicalAmount = 0;
                    if(TypeOfAppointment == 2)
                        HRAValue = 0;
                }
                else if (parseInt($('#Medical').val()) == 1)
                    MedicalAmount = parseFloat($('#DesignationMedicalamount').val()) || 0;

                ttlVal = MedicalAmount + SalaryDiff + HRAValue;
                var StartPerDay = ttlVal / StartDateTotalDays;
                var EndPerDay = ttlVal / EndDateTotalDays;
                var MonthlyAmt = ttlVal;
                if (months > 0) {
                    Tot += MonthlyAmt * count;
                }
                if (days > 0) {
                    Tot += StartWorkingDays * StartPerDay;
                    Tot += EndWorkingDays * EndPerDay;
                }
                if(isarrearpay == true)
                    return Tot;

                if(ttlVal < 0) {
                    ttlVal = Math.abs(ttlVal);
                    $('#isWithdrawCommitment').val(true);
                    CommitmentDiff = OldCommitmentAmmount + Tot;
                    Tot = Math.abs(Tot);
                }
                else {
                    $('#isWithdrawCommitment').val(false);
                    CommitmentDiff = Tot;
                }
                //UpdateValue
                if (TypeOfAppointment == 2) {
                    $('#MedicalAmmount').val(0);
                    $("#HRA").val(0);
                }
                else if(isMsPhd) {
                    $('#MedicalAmmount').val(0);
                    $("#HRA").val(HRAValue.toFixed(2));
                }

                if (parseInt($('#Medical').val()) != 3)
                    $('#MedicalAmmount').val($('#DesignationMedicalamount').val());
                $('#CommitmentAmount').val(Math.round(CommitmentDiff));
                $('#WithdrawalAmount').val(Math.round(Tot));
                $('#txt-WithdrawCommitment').text(Math.round(Tot));
            }
        }
        else if(typcategory=="CON")
        {
            debugger;
            if ($('#FromDate').val() != "" && $('#ToDate').val() != "") {
                var startdate = new Date($('#FromDate').val().split('-').join('/'));
                var enddate = new Date($('#ToDate').val().split('-').join('/'));
                if(isarrearpay == true) {
                    enddate = new Date($('#ArrearOrDeductionTillDate').val().split('-').join('/'));
                }
                var count = monthCount(startdate,enddate);
                //define moments for the startdate and enddate
                var StartDateTotalMonth = parseInt(endOfMonth(startdate).getDate());
                var EndDateTotalMonth = parseInt(endOfMonth(enddate).getDate());
                var StartWorkingDays =0;
                var EndWorkingDays=0;
                if(startdate.getMonth()==enddate.getMonth()&&startdate.getFullYear()==enddate.getFullYear()){
                    StartWorkingDays=parseInt(enddate.getDate()) - parseInt(startdate.getDate())+1;
                }
                else{
                    StartWorkingDays=StartDateTotalMonth - parseInt(startdate.getDate()) + 1;
                    EndWorkingDays = enddate.getDate();
                }

                var months = count || 0;
                var days = StartWorkingDays + EndWorkingDays;
                var HRAValue = 0;
                var ttlVal = 0;
                var Salary = parseFloat($('#Salary').val()) || 0;
                var OldGST=parseFloat($("#OldGST").val()) || 0;
                var taxVal = parseFloat($('#GST').val()) || 0;
                var SalaryDiff=0;
                var AppointmentStartdt=new Date('@string.Join("/",Model.OldPrjDetailModel.AppointmentStartDate.Split('-'))');
                var AppointmentClosedt=new Date('@string.Join("/",Model.OldPrjDetailModel.AppointmentClosureDate.Split('-'))');
                if($('#GST').val()==0)
                {
                    $('#IsGSTapplicable').val("No");
                }
                else
                {
                    $('#IsGSTapplicable').val("Yes");
                }
                var gstamt=0;
                if ((startdate >= AppointmentStartdt && enddate <= AppointmentClosedt)) {
                    //enhancement within tenure

                    if (Salary > 0) {
                        if(OldSalary > Salary){
                            $('#isWithdrawCommitment').val(true);
                            SalaryDiff = OldSalary - Salary;
                        }
                        else{
                            $('#isWithdrawCommitment').val(false);
                            SalaryDiff = Salary - OldSalary;
                        }
                    }

                    if(taxVal > 0)
                    {
                        if(OldGST > taxVal){
                            taxVal = OldGST - taxVal;
                        }
                        else{
                            taxVal = taxVal - OldGST;
                        }

                        if(SalaryDiff == 0)
                        {
                            //SalaryDiff = Salary;
                            gstamt = (Salary * taxVal / 100);
                        }
                        else{
                            gstamt = (SalaryDiff * taxVal / 100);
                        }
                    }
                    //else
                    //{
                    //    if(SalaryDiff==0)
                    //    {
                    //        SalaryDiff=Salary;
                    //    }
                    //}
                }
                else {
                    //enhancement out of tenure
                    $('#isWithdrawCommitment').val(false);
                    SalaryDiff = Salary;
                    gstamt=(SalaryDiff * taxVal / 100);
                }



                var Tot = 0;
                ttlVal = SalaryDiff + gstamt;
                var StartPerDay = ttlVal / StartDateTotalMonth;
                var EndPerDay = ttlVal / EndDateTotalMonth;
                var MonthlyAmt = ttlVal;
                if (months > 0) {
                    Tot += MonthlyAmt * count;
                }
                if (days > 0) {
                    Tot += StartWorkingDays * StartPerDay;
                    Tot += EndWorkingDays * EndPerDay;
                }
                if(isarrearpay == true)
                    return Tot;
                var GSTDiff=0;
                var CommitmentDiff=0;

                if ((startdate >=AppointmentStartdt && enddate <= AppointmentClosedt)) {
                    //enhancement within tenure
                    if(OldSalary  >Salary)
                    {
                        CommitmentDiff = OldCommitmentAmmount - Tot;
                    }
                    else
                    {
                        CommitmentDiff = OldCommitmentAmmount + Tot;
                    }
                }
                else
                {
                    //enhancement out of tenure
                    CommitmentDiff=Tot;
                }
                $('#CommitmentAmount').val(Math.round(CommitmentDiff));
                $('#WithdrawalAmount').val(Math.round(Tot));
                $('#txt-WithdrawCommitment').text(Math.round(Tot));
            }
        }
        else if(typcategory=="OSG")
        {
            if ($('#FromDate').val() != "" && $('#ToDate').val() != "") {
                var startdate = new Date($('#FromDate').val().split('-').join('/'));
                var enddate = new Date($('#ToDate').val().split('-').join('/'));
                if(isarrearpay == true) {
                    enddate = new Date($('#ArrearOrDeductionTillDate').val().split('-').join('/'));
                }
                var lwfamt = 0;
                var count = monthCount(startdate,enddate);
                //define moments for the startdate and enddate
                var StartDateTotalDays = parseInt(endOfMonth(startdate).getDate());
                var EndDateTotalDays = parseInt(endOfMonth(enddate).getDate());
                var StartWorkingDays =0;
                var EndWorkingDays=0;
                if(startdate.getMonth() == enddate.getMonth() && startdate.getFullYear() == enddate.getFullYear()){
                    StartWorkingDays = parseInt(enddate.getDate()) - parseInt(startdate.getDate())+1;
                }
                else{
                    StartWorkingDays=StartDateTotalDays - parseInt(startdate.getDate()) + 1;
                    EndWorkingDays = enddate.getDate();
                }
                var months =count || 0;
                var days = StartWorkingDays + EndWorkingDays;
                var HRAValue = 0;
                var ttlVal = 0;
                var MedicalAmount = $('#DesignationMedicalamount').val() || 0;
                //var Salary = parseFloat($('#Salary').val()) || 0;
                //var Salary = parseFloat($('input[name=TotalCTC]').val()) || 0;
                var Salary = parseFloat($('input[name=EmployeeCTC]').val()) || 0;
                var HRA = parseFloat($("#HRA").val()) || 0;
                var SalaryDiff = 0,HRADiff = 0,CommitmentDiff = 0;
                var newprojectId = $('input[name="ProjectId"]').val();
                var oldprojectId = $('input[name="OldPrjDetailModel.ProjectID"]').val();


                //If Check enhancement within tenure or out
                var AppointmentStartdt=new Date('@string.Join("/",Model.OldPrjDetailModel.AppointmentStartDate.Split('-'))');
                var AppointmentClosedt=new Date('@string.Join("/",Model.OldPrjDetailModel.AppointmentClosureDate.Split('-'))');
                if ((startdate >= AppointmentStartdt && enddate <= AppointmentClosedt)) {
                    SalaryDiff = Salary - OldSalary;

                    if (getBoolean($('#isHRA').val()) == true  && HRA > 0) {
                        var HRAPer = parseFloat($("#HRAPercentage").val()) || 0;
                        HRAPer = HRAPer / 100;
                        HRAValue = Salary * HRAPer;
                        if(HRAValue < HRA || HRAValue > HRA)
                            $("#HRA").val(HRAValue.toFixed(2));
                    }
                    else {
                        HRAValue = 0;
                        $("#HRA").val(0);
                    }
                    HRAValue = HRAValue - OldHRA;
                }
                else
                {
                    if(HRA > 0)
                    {
                        var HRAPer = parseFloat($("#HRAPercentage").val()) || 0;
                        HRAPer = HRAPer / 100;
                        if (getBoolean($('#isHRA').val()) == true)
                        {
                            HRAValue = Salary * HRAPer;
                            if(HRAValue < HRA)
                                $("#HRA").val(HRAValue.toFixed(2));
                            else
                                HRAValue = HRA;
                        }
                        else
                        {
                            HRAValue = 0;
                            $("#HRA").val(0);
                        }
                    }
                    //enhancement out of tenure
                    $('#isWithdrawCommitment').val(false);
                    SalaryDiff = Salary;
                }
                var Tot = 0;
                //check is ConsolidatedPay or Part time appointment
                if (isMsPhd || TypeOfAppointment == 2) {
                    MedicalAmount = 0;
                    if(TypeOfAppointment == 2){
                        HRAValue = 0;
                    }
                }
                else if (parseInt($('#Medical').val()) != 1) {
                    MedicalAmount = 0;
                }

                ttlVal = MedicalAmount + SalaryDiff + HRAValue;
                var StartPerDay = ttlVal / StartDateTotalDays;
                var EndPerDay = ttlVal / EndDateTotalDays;
                var MonthlyAmt = ttlVal;
                if (months > 0) {
                    Tot += MonthlyAmt * count;
                }
                if (days > 0) {
                    Tot += StartWorkingDays * StartPerDay;
                    Tot += EndWorkingDays * EndPerDay;
                }

                if(ttlVal < 0) {
                    ttlVal = Math.abs(ttlVal);
                    $('#isWithdrawCommitment').val(true);
                    CommitmentDiff = OldCommitmentAmmount + Tot;
                    Tot = Math.abs(Tot);
                }
                else {
                    $('#isWithdrawCommitment').val(false);
                    CommitmentDiff = Tot;
                }

                var startyear = startdate.getFullYear();
                var endyear = enddate.getFullYear();
                var startmonth = startdate.getMonth() + 1;
                var endmonth = enddate.getMonth() + 1;

                //UpdateValue
                if (TypeOfAppointment == 2) {
                    $('#MedicalAmmount').val(0);
                    $("#HRA").val(0);
                }
                else if(isMsPhd) {
                    $('#MedicalAmmount').val(0);
                    $("#HRA").val(HRAValue.toFixed(2));
                }

                if(startyear < endyear && AppointmentClosedt < startdate)
                {
                    lwfamt = parseFloat($('input[name=LWFAmount]').val()) || 0;
                    if(lwfamt > 0)
                    {
                        Tot += lwfamt;
                    }
                }
                if((startmonth == 12 ||  endmonth == 12) && startyear == endyear && AppointmentClosedt < startdate)
                {
                    lwfamt = parseFloat($('input[name=LWFAmount]').val()) || 0;
                    if(lwfamt > 0)
                    {
                        Tot += lwfamt;
                    }
                }
                if(isarrearpay == true)
                    return Tot;
                if(ttlVal < 0) {
                    ttlVal = Math.abs(ttlVal);
                    $('#isWithdrawCommitment').val(true);
                    CommitmentDiff = OldCommitmentAmmount + Tot;
                    Tot = Math.abs(Tot);
                }
                else {
                    $('#isWithdrawCommitment').val(false);
                    CommitmentDiff = Tot;
                }

                if (parseInt($('#Medical').val()) != 3)
                {
                    $('#MedicalAmmount').val($('#DesignationMedicalamount').val());
                }
                $('#CommitmentAmount').val(Math.round(CommitmentDiff));
                $('#WithdrawalAmount').val(Math.round(Tot));
                $('#txt-WithdrawCommitment').text(Math.round(Tot));
            }
        }
        textForCommitment();
    }
    calculatetaxTotal()
    $("#ToDate").change(function () {
        ValidateDateDiff();
        calculatetaxTotal()
    });

    $('#FromDate').change(function () {
        var OldProject=$('input[name="OldPrjDetailModel.ProjectID"]').val();
        var ProjectId=$('input[name="ProjectId"]').val();
        var strAppointmentClosure = @Html.Raw(Json.Encode(Model.OldPrjDetailModel.AppointmentClosureDate));
        var AppointmentClosedt=new Date(strAppointmentClosure.split('-').join('/'));
        var Curr = new Date();
        var AppointmentStartDate=new Date($('#txtAppointmentStartDate').text().split('-').join('/'));
        var AppointmentEndDate=new Date($('#txtAppointmentEndDate').text().split('-').join('/'));
        var ProjectStartDate=new Date($('#txtProjectStartDate').text().split('-').join('/'));
        var ProjectEndDate=new Date($('#txtProjectClosureDate').text().split('-').join('/'));
        var FromDate=new Date($('#FromDate').val().split('-').join('/'));
        var endDate = $('#txtProjectClosureDate').text();
        var defaultstartDateDate = moment($('#FromDate').val().split('-').join('/')).add(+1, 'days').toDate();
        if (AppointmentStartDate <= FromDate && FromDate <= AppointmentEndDate)
        {
            $('#ToDate').datepicker({
                dateFormat: 'dd-MM-yy',
                changeYear: true
            }).datepicker("option", "minDate", defaultstartDateDate).datepicker("option", "maxDate", AppointmentEndDate);
            $('#ToDate').val(@Html.Raw(Json.Encode(Model.OldPrjDetailModel.AppointmentClosureDate)));
            $('#ToDate').addClass("dis-none");
            $('#txt-ToDate').removeClass("dis-none");
        }
        else if (ProjectStartDate <= FromDate && FromDate < ProjectEndDate)
        {
            var startDateDateaddyear = moment($('#FromDate').val().split('-').join('/')).add(+1, 'years').add(-1, 'days').toDate();
            if(startDateDateaddyear > ProjectEndDate) {
                startDateDateaddyear = ProjectEndDate;
            }
            $('#ToDate').datepicker({
                dateFormat: 'dd-MM-yy',
                changeYear: true
            }).datepicker("option", "minDate", defaultstartDateDate).datepicker("option", "maxDate", startDateDateaddyear);
            $('#ArrearOrDeductionTillDate').datepicker({
                dateFormat: 'dd-MM-yy',
                changeYear: true
            }).datepicker("option", "minDate", FromDate).datepicker("option", "maxDate", startDateDateaddyear);
            $('#ToDate').removeClass("dis-none");
            $('#txt-ToDate').addClass("dis-none");
            $('#ToDate').val('');
        }
        else{
            $("#FromDate").val('')
            $("#ToDate").val('')
            $.alert('Please enter valid tenure date');
            return;
        }
        ValidateDateDiff();
        if(typcategory == "OSG")
            FillSalaryCalcDetls();
        else
            calculatetaxTotal()
    });

    function ValidateDateDiff() {
        var strDate = $("#FromDate").val();
        var clsDate = $("#ToDate").val();
        var StartDate = new Date(strDate.split('-').join('/'));
        var EndDate = new Date(clsDate.split('-').join('/'));
        var txtProjectStartDate = $("#txtProjectStartDate").text();
        if (txtProjectStartDate == "") {
            $.alert('Please enter project number');
            return;
        }
        txtProjectStartDate = txtProjectStartDate.split('-').join('/');
        var ProjectStartDate = new Date(txtProjectStartDate);

        var txtProjectCloseDate = $("#txtProjectClosureDate").text();
        txtProjectCloseDate = txtProjectCloseDate.split('-').join('/')
        var ProjectCloseDate = new Date(txtProjectCloseDate);

        if (strDate != '' && clsDate != '') {
            if (!(StartDate >= ProjectStartDate && StartDate < ProjectCloseDate)) {
                $.alert('Appointment date must be between the project start date and project closure date.');
                return;
            }
            else if (!(EndDate >= ProjectStartDate && EndDate <= ProjectCloseDate)) {
                $.alert('Appointment end date must be between the project start date and project closure date and greater than appointment start date.');
                return;
            }
            var strDate1 = new Date(strDate.split('-').join('/'));
            strDate1.setMonth(parseInt(strDate1.getMonth() + 1));
        }
    }

    function parseDate(s) {
        var months = {
            january: 0, february: 1, march: 2, april: 3, may: 4, june: 5,
            july: 6, august: 7, september: 8, october: 9, november: 10, december: 11
        };
        var p = s.split('-');
        return new Date(p[2], months[p[1].toLowerCase()], p[0]);
    }


    $("#FromDate,#ToDate,#ArrearOrDeductionTillDate").datepicker({
        dateFormat: 'dd-MM-yy',
        showStatus: true,
        showWeeks: true,
        changeYear: true,
        yearRange: '1950:+30',
        highlightWeek: true,
        numberOfMonths: 1,
        showAnim: "scale",
        showOptions: {
            origin: ["top", "left"]
        }
    });

    function checkDevation() {
        var qualifi = [];
        var descipid = [];
        var marks = [];
        addyear = 0;
        var TotalExp = 0;
        var PersonName = $('#CantidateName').text();
        var InputData = [];
        InputData = {
            DesignationId: $('#DesignationId').val() || null,
            QualificationId: qualifi,
            DisciplineId: descipid,
            MarksId: marks,
            ChekSalary: $('#Salary').val(),
            AppointmentStartDate: $('#FromDate').val(),
            AppointmentEndDate: $('#ToDate').val(),
            ProjectID: $('#ProjectId').val(),
            ProjectFund: 0,
            CommitmentAmount: $('#WithdrawalAmount').val() || 0,
            PersonName: PersonName,
            OrderType: "Enhancement",
            AppId:ApplicationID,
            AppType:typcategory,
            Comments: $('textarea[name="Comments"]').val(),
            SendSalaryStructure : $('input[name="SendSalaryStructure"]:checked').val() || "",
        }
        modelData = InputData;
        $.ajax({
            type: "POST",
            url: "@Url.Action("OrderCheckDeviation", "Requirement")",
            data: modelData,
            contentType: "application/x-www-form-urlencoded",
            beforeSend: function () {
                $(".loading-bg").removeClass('dis-none');
            },
            success: function (result) {
                $(".loading-bg").addClass('dis-none');
                $("input[name=FlowofMail]").prop('checked', false);
                if (result.isRes) {
                    $("input[name=FlowofMail][value=NP]").prop('checked', true);
                    document.getElementById("nextBtn").innerHTML = "Send to clarification";
                }
                else {
                    $("input[name=FlowofMail][value=Nd]").prop('checked', true);
                    document.getElementById("nextBtn").innerHTML = "Send for approval";
                }
                if (Status == "PI Initiated" || Status == "Open" || Status == "" || Status == "Draft" || Status.includes("Note")) {
                    $("#Deviation").html(result.output);
                    $("#ShowDeviationNP").html(result.template);
                }
                else
                {
                    $("#Deviation").empty();
                    $("input[name=FlowofMail][value=Nd]").prop('checked', true);
                }
            },
            error: function (err) {
                $(".loading-bg").addClass('dis-none');
                console.log("error : " + err);
            }
        });
    }
    function AckowleadgementEmail() {
        var PersonName = $('#CantidateName').text();
        var InputData = [];
        InputData = {
            DesignationId: $('#DesignationId').val() || null,
            AppointmentReciveDate: $('#ApplicationReceiveDate').val(),
            PersonName: PersonName,
            AppointmentStartDate: $('#FromDate').val(),
            AppointmentEndDate: $('#ToDate').val(),
            OrderType: "Enhancement",
            ProjectID : $('#ProjectId').val(),
            AppId : @Html.Raw(Json.Encode(Model.ApplicationID)) || 0,
            AppType : @Html.Raw(Json.Encode(Model.TypeCode)) || "",
            SendSalaryStructure : $('input[name="SendSalaryStructure"]:checked').val() || "",
            Paytype : $('input[name="isConsolidatePay"]:checked').val() || "",
            ChekSalary: $('#Salary').val(),
            BasicPay : $('#Salary').val(),
        }
        modelData = InputData;
        $.ajax({
            type: "POST",
            url: "@Url.Action("OrderEmailProcess", "Requirement")",
            data: modelData,
            contentType: "application/x-www-form-urlencoded",
            beforeSend: function () {
                $(".loading-bg").removeClass('dis-none');
            },
            success: function (result) {
                $(".loading-bg").addClass('dis-none');
                $("#ShowDeviationND").html(result.output.Item2);
            },
            error: function (err) {
                $(".loading-bg").addClass('dis-none');
                console.log("error : " + err);
            }
        });
    }


    /* Tab Sections Start*/
    var currentTab = 0; // Current tab is set to be the first tab (0)
    showTab(currentTab); // Display the crurrent tab
    function showTab(n) {
        // This function will display the specified tab of the form...
        var x = document.getElementsByClassName("cust-tab");
        x[n].style.display = "block";

        $(".custom-nav-pills li:eq(" + n + ")").addClass("active");
        //... and fix the Previous/Next buttons:
        if (n == 0) {
            document.getElementById("prevBtn").style.display = "none";
        } else {
            document.getElementById("prevBtn").style.display = "inline";
        }
        if (n == (x.length - 1)) {
            if ($('#Status').val() == "" || $('#Status').val().includes("Open") || $('#Status').val().includes("Note to PI") || $('#Status').val().includes("PI Initiated")) {
                document.getElementById("nextBtn").style.display = "inline";
                document.getElementById("nextBtn").innerHTML = "Submit";
            }
            else {
                document.getElementById("nextBtn").style.display = "none";
                document.getElementById("nextBtn").innerHTML = "Submit";
            }

        } else {
            document.getElementById("nextBtn").innerHTML = "Next";
            document.getElementById("nextBtn").style.display = "inline";
        }
    }

    function nextPrev(n) {
        // This function will figure out which tab to display
        var x = document.getElementsByClassName("cust-tab");
        // Exit the function if any field in the current tab is invalid:
        var v = n;
        if($('#nextBtn').text().includes("Send")||$('#nextBtn').text().includes("Submit")){
            v = 2;
        }

        if (n > 0 && !validateForm(v)) {

            return false;
        }


        if($('#Comments').val() != '') {
            $('#txt-Comments').text($('#Comments').val());
        }

        if (currentTab + n < x.length) {
            // Hide the current tab:
            x[currentTab].style.display = "none";
            $(".custom-nav-pills li:eq(" + currentTab + ")").removeClass("active");
        }
        else {
            // ... the form gets submitted:
            // ... Update checklist in the deviation
            var CheckedValue = [];
            $('#tbodyDEVCheckList').find('input[id^="DeviationCheckId_"]').each(function(){
                if ($(this).is(':checked')) {
                    var str = $(this).attr('name');
                    var matches = str.match(/(\d+)/);
                    var value = ""
                    if (matches)
                        value = $('input[name="CheckListDetail[' + matches[0] + '].FunctionCheckListId"]').val();
                    CheckedValue.push(value);
                }
            });
            $('.CheckListBody').find('tr[class^="Checklist_"]').each(function() {
                $(this).addClass('dis-none');
            });

            if(CheckedValue.length > 0) {
                for(var i = 0;i < CheckedValue.length;i++)
                {
                    $('.Checklist_' + CheckedValue[i]).removeClass('dis-none');
                }
            }
            $('.CheckListBody').find('tr:not(.dis-none)').each(function(e) {
                $(this).find('.dyn-srl-No').text(parseInt(e));
            });

            if($('input[name="FlowofMail"]:checked').val() != "Nd")
            {
                //Deviation mail Preview
                var Comments = $('textarea[name="Comments"]').val();
                if(Comments != "")
                    $('#tr-cmt').removeClass('dis-none');
                else
                    $('#tr-cmt').addClass('dis-none');
                $('#txt-mail-comments').text(Comments);
                $('#ShowDeviationND').hide();
                $('#ShowDeviationNP').show();
                PopupConfirm()
            }
            else if ($('input[name="FlowofMail"]:checked').val() == "Nd" && ((@Html.Raw(Json.Encode(Model.MailSent_f)) == false && (typcategory == "STE" || typcategory == "CON"))  || (typcategory == "OSG" && $('input[name="SendSalaryStructure"]:checked').val() == "SST")))
            {
                //Process mail Preview is occur only once for application save
                $('#ShowDeviationND').empty();
                $('#ShowDeviationNP').hide();
                $('#ShowDeviationND').show();
                AckowleadgementEmail()
                PopupConfirm()
            }
            else if(getBoolean($('#isWithdrawCommitment').val()))
            {
                $('#ShowDeviationND').empty();
                $('#ShowDeviationNP').hide();
                $('#ShowDeviationND').show();
                AckowleadgementEmail()
                PopupConfirm()
            }
            else
                formSave();
            return false;
        }
        // Increase or decrease the current tab by 1:
        currentTab = currentTab + n;

        // Otherwise, display the correct tab:
        showTab(currentTab);
    }


    if(@Json.Encode(Model.WithdrawalAmount) > 0)
        $('#txt-WithdrawCommitment').text('@Json.Encode(Model.WithdrawalAmount)');
    textForCommitment();
    function textForCommitment(){
        if(getBoolean($('#isWithdrawCommitment').val()))
        {
            $('.mt-xs').text('Withdraw commitment');
        }
        else{
            $('.mt-xs').text('Additional commitment');
        }
    }


    function validateForm(n) {
        // This function deals with validation of the form fields
        var isValid = false;
        var hadError = false;
        var tabs = $("#formExtension");
        var inputs = $(":input, textarea, select"); // get all the form inputs and selects
        var stepElements = $(tabs).find(inputs); // get inputs for current step
        var count = stepElements.length; // check that there are inputs
        if (count <= 0) {                // if there are not no reason to loop them
            return true;
        }
        $(stepElements).each(function (idx) {
            if (!$(this).is(':radio') && !$(this).is(':checkbox')) {
                isValid = $(this).valid();//$(document.forms[0]).validate().element($(this)); // check that the input is valid. This can also be used on a per input basis to perform another action if the field is not valid.
                if (!isValid) {
                    hadError = true;
                } // set our flag if there was an error
            }
        });
        if (!hadError && n != 2 && ($('#Status').val() == "" || $('#Status').val().includes("Open") || $('#Status').val().includes("Note to PI") || $('#Status').val().includes("PI Initiated"))) {

            if ($('#FromDate').val() == "" || $('#ToDate').val() == "") {
                $.confirm({
                    title: 'Warning!',
                    content: 'Please enter enhancement from date & to date',
                    type: 'orange',
                    buttons: {
                        Ok: function () {
                            //close
                        },
                    },
                });
                return false;
            }

            if($('input[name=isConsolidatePay]:checked').val() == "" || $('input[name=isConsolidatePay]:checked').val() == undefined){
                $.confirm({
                    title: 'Warning!',
                    content: 'Invalid data exist.Please select Consolidatepay or Fellowship',
                    type: 'orange',
                    buttons: {
                        Ok: function () {
                            //close
                        },
                    },
                });
                return false;
            }

            var MinSalary = parseFloat($('#MinSalary').val());
            var Salary = parseFloat($('#Salary').val());
            if(TypeOfAppointment == 2) {
                MinSalary = MinSalary / 2;
            }
            if(MinSalary > Salary){
                $.confirm({
                    title: 'Warning!',
                    content: 'Salary mentioned is below the institution norms',
                    type: 'orange',
                    buttons: {
                        Ok: function () {
                            //close
                        },
                    },
                });
                return false;
            }
            else
            {
                if ($('#DesignationId').val() != null || $('#DesignationId').val() != "") {
                    if(!getBoolean($('#isWithdrawCommitment').val())) {
                        checkDevation();
                    }
                    else {
                        $("input[name=FlowofMail][value=Nd]").prop('checked', true);
                    }
                }
            }
        }
        if(hadError){
            $.confirm({
                title: 'Warning!',
                content: 'Invalid data exist',
                type: 'orange',
                buttons: {
                    Ok: function () {
                        //close
                    },
                },
            });
            return;
        }
        if ($('#ProjectId').val() != null || $('#ProjectId').val() != "") {
            FillData();
        }
        return !hadError; // return the valid status
    }

    function PopupConfirm() {
        $('#dialogConfirm').modal('toggle');
    }

    $('#isbtnConfirm').click(function () {
        $(this).attr("disabled", "disabled");
        $('.loading-bg').removeClass('dis-none');
        formSave()
    });

    var radioState = false;
    function checkuncheck(element){
        if(radioState == false) {
            check();
            radioState = true;
        }else{
            uncheck();
            radioState = false;
        }
    }
    function check() {
        document.getElementById("IsSendSalaryStructure").checked = true;
    }
    function uncheck() {
        document.getElementById("IsSendSalaryStructure").checked = false;
    }


    function formSave() {
        var isValid = $('#formExtension').valid();
        if (!isValid)
            return false;
        if(typcategory == "OSG")
        {
            if(document.getElementById("IsSendSalaryStructure").checked == false){
                $.confirm({
                    title: 'Alert!',
                    content: 'Send Pay structure option is not selected. Pay structure will not be sent to PI. To continue click Ok. To change click Close',
                    type: 'orange',
                    buttons: {
                        Ok: function () {
                            //submit
                            if (isValid)
                                $('#formExtension').submit();
                        },
                        Close: function(){
                            //close
                            $('#isbtnConfirm').attr("disabled", false);
                            $(".loading-bg").addClass('dis-none');
                        }
                    },
                });
            }
            else if(document.getElementById("IsSendSalaryStructure").checked == true)
            {
                if (isValid)
                    $('#formExtension').submit();
            }
        }
        else
        {

            if (isValid)
                $('#formExtension').submit();
        }

    }


    $(document).on('click', '#btnViewSummary', function () {
        var projNo = $('#ProjectId').val() || 0;
        if (projNo > 0) {
            var searchData = { "ProjectId": projNo };
            $.ajax({
                url: "@Url.Action("_ProjectSummary", "CoreAccounts")",
                type: "POST",
                data: searchData,
                contentType: "application/x-www-form-urlencoded",
                beforeSend: function () {
                    $(".loading-bg").removeClass('dis-none');
                },
                success: function (result) {
                    $(".loading-bg").addClass('dis-none');
                    $("#popup").html(result);
                    $("#projectSummaryModal").modal('toggle');
                },
                error: function (err) {
                    console.log("error : " + err);
                }
            });
        }
    });

    function isNumberKey(evt) {
        var charCode = (evt.which) ? evt.which : evt.keyCode;
        if (charCode != 46 && charCode > 31
          && (charCode < 48 || charCode > 57))
            return false;

        return true;
    }


    var isMedical = $('select[name="Medical"]').val();
    if (isMedical != "") {
        $('#divMedicalAmmount').removeClass('dis-none');
        if (isMedical == 1||isMedical ==2) {
            $('#MedicalAmmount').val($('#DesignationMedicalamount').val());
        }
        else if (isMedical == 3) {
            $('#MedicalAmmount').val(0);
            $('#divMedicalAmmount').addClass('dis-none');
        }
    }


    $(document).on('change', 'input[name$=".IsChecked"]', function () {
        var isUnchecked = false;
        $('input[name$=".IsChecked"]').each(function () {
            if ($(this).is(':checked')) {
                isUnchecked = true;
            }
        });
        $("input[name=FlowofMail]").prop('checked', false);

        if (!isUnchecked) {
            $("input[name=FlowofMail][value=Nd]").prop('checked', true);
            $('#nextBtn').text('Send for approval');
        }
        else {
            $("input[name=FlowofMail][value=NP]").prop('checked', true);
            $('#nextBtn').text('Send for clarification');
        }
    });

    $(document).on('change', 'input[name="FlowofMail"]', function () {
        var isUnchecked = false;
        var value = $('input[name="FlowofMail"]:checked').val();
        if (value == "Nd") {
            $('input[name$=".IsChecked"]').each(function () {
                $(this).prop('checked', false);
            });
            $('#nextBtn').text('Send for approval');
        }
        else {
            $('input[name$=".IsChecked"]').each(function () {
                $(this).prop('checked', true);
            });
            $('#nextBtn').text('Send to clarification');
        }
    });

    $('a[name="DocDownload"]').click(function (p) {
        p.preventDefault();
        var ref = $(this).attr('href');
        var win = window.open('', '_blank');
        win.location.href = ref;
    });

    var findtabs = $(".cust-tab");
    $(findtabs[0]).find('textarea,input[type="text"]').each(function () {
        var ID = $(this).attr('id');
        var name = $(this).attr('name').split('.')[1];
        var NotinID = ["DesignationCode" , "ProjectNumber" , "Comments"];
        var NotinEndName = ["DesignationautoComplete"];
        if (!NotinID.includes(ID) && !NotinEndName.includes(name)) {
            $(this).attr('style', 'text-transform:uppercase');
        }
    });

    $(document).on('keyup','textarea,input[type="text"]',function(event) {
        if($(this).attr('id') != "Comments" && $(this).attr('id') != "PIJustificationRemarks" && $(this).attr('id') != undefined) {
            var input = event.target;
            var start = input.selectionStart;
            var end = input.selectionEnd;
            input.value = input.value.toLocaleUpperCase();
            input.setSelectionRange(start, end);
        }
    });

    function FillData() {
        var isConsolidatePay = $('input[name=isConsolidatePay]:checked').val();

        $('#lblDesignationName1').text($('#Designation').val());
        $('#ClDesignation').text($('#Designation').val());
        $('#lblPay').text($('#Salary').val());
        $('#lblMedical').text($('#MedicalAmmount').val());
        $('#ApplicationRevDate').text($('#ApplicationReceiveDate').val());
        $('#txtMedical1').text($("#Medical option:selected").text());
        $('#lblAppStartDate1').text($('#FromDate').val());
        $('#lblAppEndDate1').text($('#ToDate').val());
        $('#lblCommitmentAmt1').text($('#CommitmentAmount').val());
        $('#ClReceivedDate').val($("#ApplicationReceiveDate").val());
        $('#ClConsolidatedPay').prop('checked',false);
        $('#ClFellowship').prop('checked',false);
        $('#txtProjectNumber').text($('#ProjectNumber').val());
        $('#lblDesignationCode1').text($('#DesignationCode').val());
        if(isConsolidatePay != "")
        {
            if($('input[name=isConsolidatePay]:checked').val() == "ConsolidatedPay") {
                $('input[name=ClConsolidatedPay]').prop('checked',true);
            }
            else {
                $('input[name=ClFellowship]').prop('checked',true);
            }
        }
        UpdateUploadedDoc();
    }

    MedicalNotApplicable();
    $('#TypeofappointmentId').change(function(){
        MedicalNotApplicable();
        calculatetaxTotal();
    });

    $('#RequestReference').change(function () {
        var selSource = $(this).val();
        $("#SourceReferenceNumber,#ReferenceNo").val('');
        $("#divRefNum, #divRefEmailDate").addClass('dis-none');
        $("#SourceTapalOrWorkflow").val('False');
        if (selSource == '1') {
            applyAutoComplete($('#ReferenceNo'), $('#SourceReferenceNumber'), "@Url.Action("GetACWorkflowRefNumber", "Proposal")");
            $("#divRefNum").removeClass('dis-none');
            $("#SourceTapalOrWorkflow").val('True');
        } else if (selSource == '3') {
            applyAutoComplete($('#ReferenceNo'), $('#SourceReferenceNumber'), "@Url.Action("GetACTapalRefNumber", "Proposal")");
            $("#divRefNum").removeClass('dis-none');
            $("#SourceTapalOrWorkflow").val('True');
        }
        else if (selSource == '2') {
            $('#divRefEmailDate').removeClass('dis-none');
            $("#SourceTapalOrWorkflow").val('False');
        } else {
            $("#divRefNum").removeClass('dis-none');
            $("#SourceTapalOrWorkflow").val('True');
        }
    });


    var selSource = $('#RequestReference').val();
    $("#divRefNum, #divRefEmailDate").addClass('dis-none');
    if (selSource == '1') {
        applyAutoComplete($('#ReferenceNo'), $('#SourceReferenceNumber'), "@Url.Action("GetACWorkflowRefNumber", "Proposal")");
        $("#divRefNum").removeClass('dis-none');
        $("#SourceTapalOrWorkflow").val('True');
    }
    else if (selSource == '3') {
        applyAutoComplete($('#ReferenceNo'), $('#SourceReferenceNumber'), "@Url.Action("GetACTapalRefNumber", "Proposal")");
        $("#divRefNum").removeClass('dis-none');
        $("#SourceTapalOrWorkflow").val('True');
    }
    else if (selSource == '2') {
        $('#divRefEmailDate').removeClass('dis-none');
        $("#SourceTapalOrWorkflow").val('False');
    }
    else {
        $("#divRefNum").removeClass('dis-none');
        $("#SourceTapalOrWorkflow").val('True');
    }


    function MedicalNotApplicable(){
        //Medical benefit and Hospital charges  is not applicable for Part Time  & MS/ Phd candidates
        if(TypeOfAppointment==2){
            $('#HRAText').removeClass('dis-none');
            $('#HRAText').text(0);
            $('#HRA').addClass('dis-none');
            UpdateMedical(3);

        }
        else{
            $('#HRA').removeClass('dis-none');
            $('#HRAText').addClass('dis-none');
            if(!isMsPhd){
                var ishaveMedical=getBoolean($('#isMedical').val());
                if(ishaveMedical==true){
                    UpdateMedical(2);
                }
                else{
                    UpdateMedical(3);
                }
            }
        }
    }
    $('input[name="PILetter"]').change(function (event) {
        $('#PILetter').empty();
        var form_data = new FormData();
        var _size = this.files[0].size;
        var iSize = (_size / 1024);
        iSize = (Math.round(iSize * 100) / 100)
        // Read selected files
        var allowedExtensions = [".pdf", ".doc", ".docx"];
        var totalfiles = document.getElementById('PILetter').files.length;
        for (var index = 0; index < totalfiles; index++) {
            var fileName = document.getElementById('PILetter').files[index].name;
            var extension = fileName.substr((fileName.lastIndexOf('.') + 1)).toLowerCase();
            var validFormat = allowedExtensions.includes('.' + extension);
            if (!validFormat) {
                $('#FailedAlert').html('PI Letter File should be allowed olny document type [pdf,doc,docx]');
                $('#Failed').modal('toggle');
                $(this).val('');
                return;
            }
            else {
                if (iSize > 5120) {
                    $('#FailedAlert').html('Documents size should be allow below 5MB');
                    $('#Failed').modal('toggle');
                    $(this).val('');
                    return;
                }
            }
        }
    });
    function getBoolean(value){
        switch(value){
            case true:
            case "true":
            case "True":
            case 1:
            case "1":
            case "on":
            case "yes":
                return true;
            default:
                return false;
        }
    }

    $('select[name="Medical"]').on('change', function () {
        $('#divMedicalAmmount').removeClass('dis-none');
        if ($(this).val() == 1||$(this).val() == 2) {
            $('#MedicalAmmount').val($('#DesignationMedicalamount').val());
            $('#hdnMedical').val($(this).val());
        }
        else {
            $('#MedicalAmmount').val(0);
            $('#hdnMedical').val(3);
            $('#divMedicalAmmount').addClass('dis-none');
        }
        calculatetaxTotal();
        if($('#ArrearOrDeductionTillDate').val() != "") {
            var Arrearamount = calculatetaxTotal(true) || 0;
            $('#ArrearOrDeductionAmount').val(Math.round(Arrearamount));
        }
    });


    $(document).on('click', '#btnViewStaffAllocation', function () {
        var projNo = $('#ProjectId').val() || 0;
        if (projNo > 0) {
            var searchData = { "ProjectId": projNo };
            $.ajax({
                url: "@Url.Action("ViewStaffAllocation", "Requirement")",
                type: "POST",
                data: searchData,
                contentType: "application/x-www-form-urlencoded",
                beforeSend: function () {
                    $(".loading-bg").removeClass('dis-none');
                },
                success: function (result) {
                    $(".loading-bg").addClass('dis-none');
                    $("#popup").html(result);
                    $("#myModal1").modal('toggle');
                },
                error: function (err) {
                    console.log("error : " + err);
                    $(".loading-bg").addClass('dis-none');
                }
            });
        }
    });
    function UpdateMedical(value)
    {
        if(value == 1 || value == 2){
            $('#Medical').val(value);
            $('#Medical').removeClass('dis-none');
            $('#MedicalAmmount').val(parseFloat($('#DesignationMedicalamount').val()))
            $('#MedicalText').addClass('dis-none');

        }
        else if(value == 3 || value == 0) {
            if(!getBoolean($('#isMedical').val())) {
                $('#Medical').addClass('dis-none');
                $('#MedicalText').removeClass('dis-none');
            }
            else
            {
                $('#Medical').removeClass('dis-none');
                $('#MedicalText').addClass('dis-none');
            }
            $('#Medical').val(value);
            $('#MedicalAmmount').val(0);

        }
        $('#MedicalText,#txtMedical1').text($("#Medical option:selected").text());
    }

    $('#SourceEmailDate').change(function(){
        var value=$(this).val();
        $('#ApplicationReceiveDate').val(value);
    });

    $('input[name="isConsolidatePay"]').change(function(){
        $('#DesignationCode').val("");
    });


    var inncPIJus = 1;
    $("#btnAddFile").click(function () {
        var cln = $('div#divPIJustification:first').clone().find("input").val("").end();
        $(cln).find('a').removeClass('dis-none');
        $(cln).find("input, select").each(function () {
            $(this).attr("name", $(this).attr("name").replace(/\d+/, inncPIJus));
            if ($(this).attr("id"))
                $(this).attr("id", $(this).attr("id").replace(/\d+/, inncPIJus));
        });
        $(cln).insertAfter("div#divPIJustification:last");
        inncPIJus++;
    });
    $(document).on('click', 'a.removeFile', function () {
        if ($('div#divPIJustification').length == 1) {
            $('div#divPIJustification').find("input").val("").end();
        }
        else{
            $(this).closest('div').remove();
            UpdateUploadedDoc();
            $(document).find('input[name^="PIJustificationFile"]').each(function(idx,ele){
                $(this).attr("name", $(this).attr("name").replace(/\d+/, idx));
                if ($(this).attr("id"))
                    $(this).attr("id", $(this).attr("id").replace(/\d+/, idx));
            });
            inncPIJus--;
        }
    });
    function UpdateUploadedDoc(){
        var form_data = new FormData();
        $('#fileAppend').empty();
        $(document).find('input[name^="PIJustificationFile"]').each(function(idx,ele){
            var val=$(this).val();
            var ID=$(this).attr('id');
            if(val!=""){
                var tmppath= URL.createObjectURL(document.getElementById(ID).files[0]);
                var fileN = document.getElementById(ID).files[0].name;
                var ele = document.createElement('a');
                var elebr = document.createElement('br');
                ele.href =tmppath
                ele.text=fileN;
                ele.name="DocDownload";
                document.getElementById('fileAppend').appendChild(ele);
                document.getElementById('fileAppend').appendChild(elebr);
            }
        });
    }
    $(document).on('change','input[name^="PIJustificationFile"]', function(event) {
        var id = $(this).attr('id');
        id = id.split('_')[1];
        if($(this).val() != "")
        {
            // Read selected files
            var allowedExtensions =[".pdf", ".doc",".docx"];
            var fileName = document.getElementById('PIJustificationFile_'+id).files[0].name;
            var extension = fileName.substr((fileName.lastIndexOf('.') + 1)).toLowerCase();
            var validFormat=allowedExtensions.includes('.'+extension);
            if(validFormat){
                var _size = document.getElementById('PIJustificationFile_'+id).files[0].size;
                var iSize = (_size / 1024);
                iSize = (Math.round(iSize * 100) / 100)
                if (iSize > 5120) {
                    $('#FailedAlert').html('Documents size should be allow below 5MB');
                    $('#Failed').modal('toggle');
                    $(this).val('');
                    return;
                }
                UpdateUploadedDoc();
            }
            else {
                $('#FailedAlert').html('PIJustification allowed document type [pdf,doc,docx]');
                $('#Failed').modal('toggle');
                $(this).val('');
                return;
            }
        }
        else{
            UpdateUploadedDoc()
        }
    });


    function FormDisabled() {
        $("#formExtension").find("input, select, textarea").each(function () {
            var idDisabled = $(this).is(":disabled");
            var id = $(this).attr('id');
            if (!idDisabled) {
                $(this).attr("disabled", "disabled");
            }
        });
    }
    var Status = '@Model.Status';
    var isDisabledStatus = ["","Open","Note to PI" , "PI Initiated"];
    if (!isDisabledStatus.includes(Status)) {
        FormDisabled();
        $('#btnViewSummary').removeAttr('disabled');
        $('#btnViewStaffAllocation').removeAttr('disabled');
    }


    $('#VendorId').change(function () {
        FillSalaryCalcDetls();
        //calculatetaxTotal();
    });


    function FillSalaryCalcDetls() {
        var Vendorid = $('#VendorId').val();
        var salary = $('#Salary').val();
        var emppfbasicwages = $('input[name=EmpPFBasicWages]').val() || 0;
        var isemppfwages = true;
        $.getJSON("@Url.Action("LoadSalCalPercent", "Requirement")", { VendorId: Vendorid, Salary: salary },
    function (result) {
        var emppfpercent = result.EmployeePfPercent * (1 / 100);
        var emplyrpfpercent = result.EmployerPfPercent * (1 / 100);
        var empESICpercent = result.EmployeeESIC * (1 / 100);
        var emplyrESICpercent = result.EmployerESIC * (1 / 100);
        var genESICSlab = result.GenESICSlab || 0;
        if(genESICSlab == 0)
        {
            genESICSlab = 21000;
        }
        var phESICSlab = result.PhESICSlab || 0;
        if(phESICSlab == 0)
        {
            phESICSlab = 25000;
        }
        var pfSlab = result.PFSlab;
        var profesTax = result.ProfessionalTax;
        var LWFAmount = result.LWFEmlyrAmount;
        var agncyfee = result.AgencyFee * (1 / 100);
        var statutoryId = result.StatutoryId;
        //var gstpercent = result.GSTPercentage * (1 / 100);
        var gstpercent = 0.18;
        var ins = result.Insurance || 0;
        if(emppfbasicwages > pfSlab && pfSlab > 0)
        {
            emppfbasicwages = pfSlab;
        }
        var name = $('input[name=Name]').val();
        var salary = Math.round($('input[name=Salary]').val());
        var designation = $('input[name=Designation]').val();
        var profesionalId = $('select[name=ProfessionalId]').val();
        //var typeofappoint = $('select[name=TypeofappointmentId]').selected.text();
        var typeofappoint = $( "select[name=TypeofappointmentId] option:selected" ).text();
        var isphysichandc = $( "select[name=PhysicallyChallenged] option:selected" ).text();
        if(isphysichandc == "Select")
        {
            $("#lblPHYHandC").html('No Input');
        }
        if(isphysichandc != "Select")
        {
            $("#lblPHYHandC").html(isphysichandc);
        }
        var emptype = "";
        if($('#IsNew').is(':checked'))
        {
            emptype = $('#IsNew').val();
        }
        else if($('#IsOld').is(':checked'))
        {
            emptype = $('#IsOld').val();
        }
        $('select[name=EmpSalutation]').val(profesionalId);
        $('input[name=EmpSalutation]').val(profesionalId);
        $('input[name=EmpName]').val(name);
        $('input[name=EmpDesig]').val(designation);
        $('input[name=RecommendedSalary]').val(salary);
        $('input[name=LWFAmount]').val(LWFAmount);
        $('input[name=StatutoryId]').val(statutoryId);
        $("#lblRecommendedSalary").html(salary);
        $("#lblEmplType").html(emptype);
        $("#lblEmployeeESICPer").text(result.EmployeeESIC);
        $("#lblEmployerESICPer").text(result.EmployerESIC);
        $("#lblAgencyFeePer").text(result.AgencyFee);
        $("#lblSalaryGSTPer").text(result.GSTPercentage);
        if(typeofappoint != null && typeofappoint != "" && typeofappoint != "Select Appointment")
        {
            $("#lblAppointType").html(typeofappoint);
        }
        if(typeofappoint == "Select Appointment")
        {
            $("#lblAppointType").html('No Input');
        }

        if(salary <= pfSlab)
        {
            $('input[name=EmpPFBasicWages]').val(salary);

            var empPF = Math.round(salary * emppfpercent) || 0;
            $('input[name=EmployeePF]').val(empPF);
            $("#lblEmpPFBasicWages").html(salary);

            $("#lblGrossSalary").html(salary);
            $("#lblEmployeePF").html(empPF);
            var empESIC = Math.ceil(salary * empESICpercent) || 0;
            $('input[name=EmployeeESIC]').val(empESIC);
            $("#lblEmployeeESIC").html(empESIC);
            //$('input[name=EmpPFBasicWages]').attr('readonly',true);
            if(isemppfwages == true && emppfbasicwages == 0)
            {
                $('input[name=EmpPFBasicWages]').val(emppfbasicwages);
                $("#lblEmpPFBasicWages").html(emppfbasicwages);
                $('input[name=EmployeePF]').val(0);
                $("#lblEmployeePF").html(0);
                //$('input[name=EmployeeESIC]').val(0);
                //$("#lblEmployeeESIC").html(0);
                empPF = 0;
                // empESIC = 0;
            }
            if(isemppfwages == true && emppfbasicwages > 0)
            {
                $('input[name=EmpPFBasicWages]').val(emppfbasicwages);
                //$('input[name=EmployeePF]').val(0);
                //$("#lblEmployeePF").html(0);
                //$('input[name=EmployeeESIC]').val(0);
                //$("#lblEmployeeESIC").html(0);
                //empPF = 0;
                //empESIC = 0;
                empPF = Math.round(emppfbasicwages * emppfpercent) || 0;
                $('input[name=EmployeePF]').val(empPF);
                $("#lblEmpPFBasicWages").html(emppfbasicwages);

                $("#lblGrossSalary").html(salary);
                $("#lblEmployeePF").html(empPF);
                empESIC = Math.ceil(salary * empESICpercent) || 0;
                $('input[name=EmployeeESIC]').val(empESIC);
                $("#lblEmployeeESIC").html(empESIC);
            }
            if(typeofappoint == "Part time")
            {
                $('input[name=EmpPFBasicWages]').val(0);
                $("#lblEmpPFBasicWages").html(0);
                $('input[name=EmployeePF]').val(0);
                $("#lblEmployeePF").html(0);
                $('input[name=EmpPFBasicWages]').attr('readonly',true);
                empPF = 0;
            }
            //var empproftax = parseFloat($('input[name=EmployeeProfessionalTax]').val()) || 0;
            var empproftax = profesTax || 0;
            //if(empproftax == 0)
            //{
            //    empproftax = 208;
            //}
            if(isphysichandc == "Yes")
            {
                empproftax = 0;
            }
            $('input[name=EmployeeProfessionalTax]').val(empproftax);
            $("#lblEmployeeProfessionalTax").html(empproftax);
            var totlempdeduct = empPF + empESIC + empproftax;
            $('input[name=EmployeeTtlDeduct]').val(totlempdeduct);
            $("#lblEmployeeTtlDeduct").html(totlempdeduct);
            var empnetsalary = salary - totlempdeduct
            $('input[name=EmployeeNetSalary]').val(empnetsalary);
            $("#lblEmployeeNetSalary").html(empnetsalary);
            var employerPF = Math.round(salary * emplyrpfpercent) || 0;
            $('input[name=EmployerPF]').val(employerPF);
            $("#lblEmployerPF").html(employerPF);
            var employerESIC = Math.ceil(salary * emplyrESICpercent) || 0;
            $('input[name=EmployerESIC]').val(employerESIC);
            $("#lblEmployerESIC").html(employerESIC);
            if(isemppfwages == true && emppfbasicwages == 0)
            {
                $('input[name=EmployerPF]').val(0)
                $("#lblEmployerPF").html(0);
                //$('input[name=EmployerESIC]').val(0);
                //$("#lblEmployerESIC").html(0);
                employerPF = 0;
                //employerESIC = 0;
            }
            if(isemppfwages == true && emppfbasicwages > 0)
            {
                employerPF = Math.round(emppfbasicwages * emplyrpfpercent) || 0;
                $('input[name=EmployerPF]').val(employerPF);
                $("#lblEmployerPF").html(employerPF);
                employerESIC = Math.ceil(salary * emplyrESICpercent) || 0;
                $('input[name=EmployerESIC]').val(employerESIC);
                $("#lblEmployerESIC").html(employerESIC);
            }

            //var employerIns = parseFloat($('input[name=EmployerIns]').val()) || 0;
            var employerIns = ins;
            if(employerIns == 0)
            {
                employerIns = 250;
            }
            if(typeofappoint == "Part time")
            {
                //$('input[name=EmpPFBasicWages]').val(0);
                $('input[name=EmployerPF]').val(0)
                $("#lblEmployerPF").html(0);
                $('input[name=EmpPFBasicWages]').attr('readonly',true);
                employerIns = 0;
                employerPF = 0;
            }
            $('input[name=EmployerIns]').val(employerIns);
            $("#lblEmployerIns").html(employerIns);

            var ttlemployerContribute = employerPF + employerESIC + employerIns;
            $('input[name=EmployerTtlContribute]').val(ttlemployerContribute);
            $("#lblEmployerTtlContribute").html(ttlemployerContribute);
            var employeeCTC = salary + ttlemployerContribute;
            $('input[name=EmployeeCTC]').val(employeeCTC);
            $("#lblEmployeeCTC").html(employeeCTC);
            var agencyFee = Math.round(employeeCTC * agncyfee) || 0;
            $('input[name=AgencyFee]').val(agencyFee);
            $("#lblAgencyFee").html(agencyFee);
            var ctcwithagencyfee = agencyFee + employeeCTC;
            $('input[name=CTCwithAgencyFee]').val(ctcwithagencyfee);
            $("#lblCTCwithAgencyFee").html(ctcwithagencyfee);
            var salaryGST = Math.round(ctcwithagencyfee * gstpercent) || 0;
            $('input[name=SalaryGST]').val(salaryGST);
            $("#lblSalaryGST").html(salaryGST);
            var totalCTC = ctcwithagencyfee + salaryGST;
            $('input[name=TotalCTC]').val(totalCTC);
            $("#lblTotalCTC").html(totalCTC);
        }
        //if(salary > 15000 && salary <= 21000 && isphysichandc != "Yes")
        if(salary > pfSlab && salary <= genESICSlab && isphysichandc != "Yes")
        {
            //$('input[name=EmpPFBasicWages]').val(15000);
            //$("#lblEmpPFBasicWages").html(15000);
            $('input[name=EmpPFBasicWages]').val(0);
            $("#lblEmpPFBasicWages").html(0);
            $("#lblGrossSalary").html(salary);
            var empbasicwages = $('input[name=EmpPFBasicWages]').val();
            var empPF = Math.round(empbasicwages * emppfpercent) || 0;
            $('input[name=EmployeePF]').val(empPF);
            $("#lblEmployeePF").html(empPF);
            var empESIC = Math.ceil(salary * empESICpercent) || 0;
            $('input[name=EmployeeESIC]').val(empESIC);
            $("#lblEmployeeESIC").html(empESIC);
            if(isemppfwages == true && emppfbasicwages == 0)
            {
                $('input[name=EmpPFBasicWages]').val(emppfbasicwages);
                $('input[name=EmployeePF]').val(0);
                $("#lblEmployeePF").html(0);
                //$('input[name=EmployeeESIC]').val(0);
                //$("#lblEmployeeESIC").html(0);
                empPF = 0;
                //empESIC = 0;
            }
            if(isemppfwages == true && emppfbasicwages > 0)
            {
                $('input[name=EmpPFBasicWages]').val(emppfbasicwages);

                empPF = Math.round(emppfbasicwages * emppfpercent) || 0;
                $('input[name=EmployeePF]').val(empPF);
                $("#lblEmpPFBasicWages").html(emppfbasicwages);

                $("#lblGrossSalary").html(salary);
                $("#lblEmployeePF").html(empPF);
                empESIC = Math.ceil(salary * empESICpercent) || 0;
                $('input[name=EmployeeESIC]').val(empESIC);
                $("#lblEmployeeESIC").html(empESIC);
            }
            if(typeofappoint == "Part time")
            {
                $('input[name=EmpPFBasicWages]').val(0);
                $("#lblEmpPFBasicWages").html(0);
                $('input[name=EmployeePF]').val(0);
                $("#lblEmployeePF").html(0);
                $('input[name=EmpPFBasicWages]').attr('readonly',true);
                empPF = 0;
            }
            else if(typeofappoint == "Full time")
            {
                $('input[name=EmpPFBasicWages]').removeAttr("readonly");
            }
            var empproftax = profesTax || 0;
            //var empproftax = parseFloat($('input[name=EmployeeProfessionalTax]').val()) || 0;
            //if(empproftax == 0)
            //{
            //    empproftax = 208
            //}
            if(isphysichandc == "Yes")
            {
                empproftax = 0;
            }
            $('input[name=EmployeeProfessionalTax]').val(empproftax);
            $("#lblEmployeeProfessionalTax").html(empproftax);
            var totlempdeduct = empPF + empESIC + empproftax;
            $('input[name=EmployeeTtlDeduct]').val(totlempdeduct);
            $("#lblEmployeeTtlDeduct").html(totlempdeduct);
            var empnetsalary = salary - totlempdeduct;
            $('input[name=EmployeeNetSalary]').val(empnetsalary);
            $("#lblEmployeeNetSalary").html(empnetsalary);
            var employerPF = Math.round(empbasicwages * emplyrpfpercent) || 0;
            $('input[name=EmployerPF]').val(employerPF);
            $("#lblEmployerPF").html(employerPF);
            var employerESIC = Math.ceil(salary * emplyrESICpercent) || 0;
            $('input[name=EmployerESIC]').val(employerESIC);
            $("#lblEmployerESIC").html(employerESIC);

            if(isemppfwages == true && emppfbasicwages == 0)
            {
                $('input[name=EmployerPF]').val(0)
                $("#lblEmployerPF").html(0);
                //$('input[name=EmployerESIC]').val(0);
                //$("#lblEmployerESIC").html(0);
                employerPF = 0;
                //employerESIC = 0;
            }
            if(isemppfwages == true && emppfbasicwages > 0)
            {
                employerPF = Math.round(emppfbasicwages * emplyrpfpercent) || 0;
                $('input[name=EmployerPF]').val(employerPF);
                $("#lblEmployerPF").html(employerPF);
                employerESIC = Math.ceil(salary * emplyrESICpercent) || 0;
                $('input[name=EmployerESIC]').val(employerESIC);
                $("#lblEmployerESIC").html(employerESIC);
            }
            //var employerIns = parseFloat($('input[name=EmployerIns]').val()) || 0;
            var employerIns = ins || 0;

            if(employerIns == 0)
            {
                employerIns = 250
            }
            if(typeofappoint == "Part time")
            {
                //$('input[name=EmpPFBasicWages]').val(0);
                $('input[name=EmployerPF]').val(0)
                $("#lblEmployerPF").html(0);
                $('input[name=EmpPFBasicWages]').attr('readonly',true);
                employerIns = 0;
                employerPF = 0;
            }
            else if(typeofappoint == "Full time")
            {
                $('input[name=EmpPFBasicWages]').removeAttr("readonly");
            }
            $('input[name=EmployerIns]').val(employerIns);
            $("#lblEmployerIns").html(employerIns);
            var ttlemployerContribute = employerPF + employerESIC + employerIns;
            $('input[name=EmployerTtlContribute]').val(ttlemployerContribute);
            $("#lblEmployerTtlContribute").html(ttlemployerContribute);
            var employeeCTC = salary + ttlemployerContribute;
            $('input[name=EmployeeCTC]').val(employeeCTC);
            $("#lblEmployeeCTC").html(employeeCTC);
            var agencyFee = Math.round(employeeCTC * agncyfee) || 0;
            $('input[name=AgencyFee]').val(agencyFee);
            $("#lblAgencyFee").html(agencyFee);
            var ctcwithagencyfee = agencyFee + employeeCTC;
            $('input[name=CTCwithAgencyFee]').val(ctcwithagencyfee);
            $("#lblCTCwithAgencyFee").html(ctcwithagencyfee);
            var salaryGST = Math.round(ctcwithagencyfee * gstpercent) || 0;
            $('input[name=SalaryGST]').val(salaryGST);
            $("#lblSalaryGST").html(salaryGST);
            var totalCTC = ctcwithagencyfee + salaryGST;
            $('input[name=TotalCTC]').val(totalCTC);
            $("#lblTotalCTC").html(totalCTC);
        }
        //if(salary > 15000 && salary <= 25000 && isphysichandc == "Yes")
        if(salary > pfSlab && salary <= phESICSlab && isphysichandc == "Yes")
        {
            $('input[name=EmpPFBasicWages]').val(0);
            $("#lblEmpPFBasicWages").html(0);
            $("#lblGrossSalary").html(salary);
            var empbasicwages = $('input[name=EmpPFBasicWages]').val();
            var empPF = Math.round(empbasicwages * emppfpercent) || 0;
            $('input[name=EmployeePF]').val(empPF);
            $("#lblEmployeePF").html(empPF);
            var empESIC = Math.ceil(salary * empESICpercent) || 0;
            $('input[name=EmployeeESIC]').val(empESIC);
            $("#lblEmployeeESIC").html(empESIC);
            if(isemppfwages == true && emppfbasicwages == 0)
            {
                $('input[name=EmpPFBasicWages]').val(emppfbasicwages);
                $('input[name=EmployeePF]').val(0);
                $("#lblEmployeePF").html(0);
                //$('input[name=EmployeeESIC]').val(0);
                //$("#lblEmployeeESIC").html(0);
                empPF = 0;
                //empESIC = 0;
            }
            if(isemppfwages == true && emppfbasicwages > 0)
            {
                $('input[name=EmpPFBasicWages]').val(emppfbasicwages);

                empPF = Math.round(emppfbasicwages * emppfpercent) || 0;
                $('input[name=EmployeePF]').val(empPF);
                $("#lblEmpPFBasicWages").html(emppfbasicwages);

                $("#lblGrossSalary").html(salary);
                $("#lblEmployeePF").html(empPF);
                empESIC = Math.ceil(salary * empESICpercent) || 0;
                $('input[name=EmployeeESIC]').val(empESIC);
                $("#lblEmployeeESIC").html(empESIC);
            }
            if(typeofappoint == "Part time")
            {
                $('input[name=EmpPFBasicWages]').val(0);
                $("#lblEmpPFBasicWages").html(0);
                $('input[name=EmployeePF]').val(0);
                $("#lblEmployeePF").html(0);
                $('input[name=EmpPFBasicWages]').attr('readonly',true);
                empPF = 0;
            }
            else if(typeofappoint == "Full time")
            {
                $('input[name=EmpPFBasicWages]').removeAttr("readonly");
            }
            //var empproftax = parseFloat($('input[name=EmployeeProfessionalTax]').val()) || 0;
            //if(empproftax == 0)
            //{
            //    empproftax = 208
            //}
            var empproftax = profesTax || 0;
            if(isphysichandc == "Yes")
            {
                empproftax = 0;
            }
            $('input[name=EmployeeProfessionalTax]').val(empproftax);
            $("#lblEmployeeProfessionalTax").html(empproftax);
            var totlempdeduct = empPF + empESIC + empproftax;
            $('input[name=EmployeeTtlDeduct]').val(totlempdeduct);
            $("#lblEmployeeTtlDeduct").html(totlempdeduct);
            var empnetsalary = salary - totlempdeduct;
            $('input[name=EmployeeNetSalary]').val(empnetsalary);
            $("#lblEmployeeNetSalary").html(empnetsalary);
            var employerPF = Math.round(empbasicwages * emplyrpfpercent) || 0;
            $('input[name=EmployerPF]').val(employerPF);
            $("#lblEmployerPF").html(employerPF);
            var employerESIC = Math.ceil(salary * emplyrESICpercent) || 0;
            $('input[name=EmployerESIC]').val(employerESIC);
            $("#lblEmployerESIC").html(employerESIC);

            if(isemppfwages == true && emppfbasicwages == 0)
            {
                $('input[name=EmployerPF]').val(0)
                $("#lblEmployerPF").html(0);
                //$('input[name=EmployerESIC]').val(0);
                //$("#lblEmployerESIC").html(0);
                employerPF = 0;
                //employerESIC = 0;
            }
            if(isemppfwages == true && emppfbasicwages > 0)
            {
                employerPF = Math.round(emppfbasicwages * emplyrpfpercent) || 0;
                $('input[name=EmployerPF]').val(employerPF);
                $("#lblEmployerPF").html(employerPF);
                employerESIC = Math.ceil(salary * emplyrESICpercent) || 0;
                $('input[name=EmployerESIC]').val(employerESIC);
                $("#lblEmployerESIC").html(employerESIC);
            }
            //var employerIns = parseFloat($('input[name=EmployerIns]').val()) || 0;
            var employerIns = ins || 0;
            if(employerIns == 0)
            {
                employerIns = 250
            }
            if(typeofappoint == "Part time")
            {
                //$('input[name=EmpPFBasicWages]').val(0);
                $('input[name=EmployerPF]').val(0)
                $("#lblEmployerPF").html(0);
                $('input[name=EmpPFBasicWages]').attr('readonly',true);
                employerIns = 0;
                employerPF = 0;
            }
            else if(typeofappoint == "Full time")
            {
                $('input[name=EmpPFBasicWages]').removeAttr("readonly");
            }
            $('input[name=EmployerIns]').val(employerIns);
            $("#lblEmployerIns").html(employerIns);
            var ttlemployerContribute = employerPF + employerESIC + employerIns;
            $('input[name=EmployerTtlContribute]').val(ttlemployerContribute);
            $("#lblEmployerTtlContribute").html(ttlemployerContribute);
            var employeeCTC = salary + ttlemployerContribute;
            $('input[name=EmployeeCTC]').val(employeeCTC);
            $("#lblEmployeeCTC").html(employeeCTC);
            var agencyFee = Math.round(employeeCTC * agncyfee) || 0;
            //var agencyFee = Math.round(employeeCTC * 0.0194) || 0;
            $('input[name=AgencyFee]').val(agencyFee);
            $("#lblAgencyFee").html(agencyFee);
            var ctcwithagencyfee = agencyFee + employeeCTC;
            $('input[name=CTCwithAgencyFee]').val(ctcwithagencyfee);
            $("#lblCTCwithAgencyFee").html(ctcwithagencyfee);
            var salaryGST = Math.round(ctcwithagencyfee * gstpercent) || 0;
            $('input[name=SalaryGST]').val(salaryGST);
            $("#lblSalaryGST").html(salaryGST);
            var totalCTC = ctcwithagencyfee + salaryGST;
            $('input[name=TotalCTC]').val(totalCTC);
            $("#lblTotalCTC").html(totalCTC);
        }
        if(salary > genESICSlab && isphysichandc != "Yes")
        {
            $('input[name=EmpPFBasicWages]').val(0);
            $("#lblEmpPFBasicWages").html(0);
            $("#lblGrossSalary").html(salary);
            var empbasicwages = $('input[name=EmpPFBasicWages]').val();
            var empPF = Math.round(empbasicwages * emppfpercent) || 0;
            $('input[name=EmployeePF]').val(empPF);
            $("#lblEmployeePF").html(empPF);
            var empESIC = 0;
            $('input[name=EmployeeESIC]').val(empESIC);
            $("#lblEmployeeESIC").html(empESIC);
            if(isemppfwages == true && emppfbasicwages == 0)
            {
                $('input[name=EmpPFBasicWages]').val(emppfbasicwages);
                $('input[name=EmployeePF]').val(0);
                $("#lblEmployeePF").html(0);
                $('input[name=EmployeeESIC]').val(0);
                $("#lblEmployeeESIC").html(0);
                empPF = 0;
                empESIC = 0;
            }
            if(isemppfwages == true && emppfbasicwages > 0)
            {
                $('input[name=EmpPFBasicWages]').val(emppfbasicwages);

                empPF = Math.round(emppfbasicwages * emppfpercent) || 0;
                $('input[name=EmployeePF]').val(empPF);
                $("#lblEmpPFBasicWages").html(emppfbasicwages);

                $("#lblGrossSalary").html(salary);
                $("#lblEmployeePF").html(empPF);
                //empESIC = Math.round(salary * 0.0075) || 0;
                empESIC = 0;
                $('input[name=EmployeeESIC]').val(empESIC);
                $("#lblEmployeeESIC").html(empESIC);
            }
            if(typeofappoint == "Part time")
            {
                $('input[name=EmpPFBasicWages]').val(0);
                $("#lblEmpPFBasicWages").html(0);
                $('input[name=EmployeePF]').val(0);
                $("#lblEmployeePF").html(0);
                $('input[name=EmpPFBasicWages]').attr('readonly',true);
                empPF = 0;
            }
            else if(typeofappoint == "Full time")
            {
                $('input[name=EmpPFBasicWages]').removeAttr("readonly");
            }
            //var empproftax = parseFloat($('input[name=EmployeeProfessionalTax]').val()) || 0;
            //if(empproftax == 0)
            //{
            //    empproftax = 208
            //}
            var empproftax = profesTax || 0;
            if(isphysichandc == "Yes")
            {
                empproftax = 0;
            }
            $('input[name=EmployeeProfessionalTax]').val(empproftax);
            $("#lblEmployeeProfessionalTax").html(empproftax);
            var totlempdeduct = empPF + empESIC + empproftax;
            $('input[name=EmployeeTtlDeduct]').val(totlempdeduct);
            $("#lblEmployeeTtlDeduct").html(totlempdeduct);
            var empnetsalary = salary - totlempdeduct;
            $('input[name=EmployeeNetSalary]').val(empnetsalary);
            $("#lblEmployeeNetSalary").html(empnetsalary);
            var employerPF = Math.round(emppfbasicwages * emplyrpfpercent) || 0;
            $('input[name=EmployerPF]').val(employerPF);
            $("#lblEmployerPF").html(employerPF);
            var employerESIC = 0;
            $('input[name=EmployerESIC]').val(employerESIC);
            $("#lblEmployerESIC").html(employerESIC);

            if(isemppfwages == true && emppfbasicwages == 0)
            {
                $('input[name=EmployerPF]').val(0)
                $("#lblEmployerPF").html(0);
                $('input[name=EmployerESIC]').val(0);
                $("#lblEmployerESIC").html(0);
                employerPF = 0;
                employerESIC = 0;
            }
            if(isemppfwages == true && emppfbasicwages > 0)
            {
                employerPF = Math.round(emppfbasicwages * emplyrpfpercent) || 0;
                $('input[name=EmployerPF]').val(employerPF);
                $("#lblEmployerPF").html(employerPF);
                //employerESIC = Math.round(salary * 0.0325) || 0;
                employerESIC = 0;
                $('input[name=EmployerESIC]').val(employerESIC);
                $("#lblEmployerESIC").html(employerESIC);
            }
            var employerIns = ins || 0;
            //var employerIns = parseFloat($('input[name=EmployerIns]').val()) || 0;
            if(employerIns == 0)
            {
                employerIns = 250
            }
            if(typeofappoint == "Part time")
            {
                //$('input[name=EmpPFBasicWages]').val(0);
                $('input[name=EmployerPF]').val(0)
                $("#lblEmployerPF").html(0);
                $('input[name=EmpPFBasicWages]').attr('readonly',true);
                employerIns = 0;
                employerPF = 0;
            }
            else if(typeofappoint == "Full time")
            {
                $('input[name=EmpPFBasicWages]').removeAttr("readonly");
            }
            $('input[name=EmployerIns]').val(employerIns);
            $("#lblEmployerIns").html(employerIns);
            var ttlemployerContribute = employerPF + employerESIC + employerIns;
            $('input[name=EmployerTtlContribute]').val(ttlemployerContribute);
            $("#lblEmployerTtlContribute").html(ttlemployerContribute);
            var employeeCTC = salary + ttlemployerContribute;
            $('input[name=EmployeeCTC]').val(employeeCTC);
            $("#lblEmployeeCTC").html(employeeCTC);
            //var agencyFee = Math.round(employeeCTC * 0.0194) || 0;
            var agencyFee = Math.round(employeeCTC * agncyfee) || 0;
            $('input[name=AgencyFee]').val(agencyFee);
            $("#lblAgencyFee").html(agencyFee);
            var ctcwithagencyfee = agencyFee + employeeCTC;
            $('input[name=CTCwithAgencyFee]').val(ctcwithagencyfee);
            $("#lblCTCwithAgencyFee").html(ctcwithagencyfee);
            var salaryGST = Math.round(ctcwithagencyfee * gstpercent) || 0;
            $('input[name=SalaryGST]').val(salaryGST);
            $("#lblSalaryGST").html(salaryGST);
            var totalCTC = ctcwithagencyfee + salaryGST;
            $('input[name=TotalCTC]').val(totalCTC);
            $("#lblTotalCTC").html(totalCTC);
        }
        if(salary > phESICSlab && isphysichandc == "Yes")
        {
            $('input[name=EmpPFBasicWages]').val(0);
            $("#lblEmpPFBasicWages").html(0);
            $("#lblGrossSalary").html(salary);
            var empbasicwages = $('input[name=EmpPFBasicWages]').val();
            var empPF = Math.round(empbasicwages * emppfpercent) || 0;
            $('input[name=EmployeePF]').val(empPF);
            $("#lblEmployeePF").html(empPF);
            var empESIC = 0;
            $('input[name=EmployeeESIC]').val(empESIC);
            $("#lblEmployeeESIC").html(empESIC);
            if(isemppfwages == true && emppfbasicwages == 0)
            {
                $('input[name=EmpPFBasicWages]').val(emppfbasicwages);
                $('input[name=EmployeePF]').val(0);
                $("#lblEmployeePF").html(0);
                $('input[name=EmployeeESIC]').val(0);
                $("#lblEmployeeESIC").html(0);
                empPF = 0;
                empESIC = 0;
            }
            if(isemppfwages == true && emppfbasicwages > 0)
            {
                $('input[name=EmpPFBasicWages]').val(emppfbasicwages);

                empPF = Math.round(emppfbasicwages * emppfpercent) || 0;
                $('input[name=EmployeePF]').val(empPF);
                $("#lblEmpPFBasicWages").html(emppfbasicwages);

                $("#lblGrossSalary").html(salary);
                $("#lblEmployeePF").html(empPF);
                //empESIC = Math.round(salary * 0.0075) || 0;
                empESIC = 0;
                $('input[name=EmployeeESIC]').val(empESIC);
                $("#lblEmployeeESIC").html(empESIC);
            }
            if(typeofappoint == "Part time")
            {
                $('input[name=EmpPFBasicWages]').val(0);
                $("#lblEmpPFBasicWages").html(0);
                $('input[name=EmployeePF]').val(0);
                $("#lblEmployeePF").html(0);
                $('input[name=EmpPFBasicWages]').attr('readonly',true);
                empPF = 0;
            }
            else if(typeofappoint == "Full time")
            {
                $('input[name=EmpPFBasicWages]').removeAttr("readonly");
            }
            //var empproftax = parseFloat($('input[name=EmployeeProfessionalTax]').val()) || 0;
            //if(empproftax == 0)
            //{
            //    empproftax = 208
            //}
            var empproftax = profesTax || 0;
            if(isphysichandc == "Yes")
            {
                empproftax = 0;
            }
            $('input[name=EmployeeProfessionalTax]').val(empproftax);
            $("#lblEmployeeProfessionalTax").html(empproftax);
            var totlempdeduct = empPF + empESIC + empproftax;
            $('input[name=EmployeeTtlDeduct]').val(totlempdeduct);
            $("#lblEmployeeTtlDeduct").html(totlempdeduct);
            var empnetsalary = salary - totlempdeduct;
            $('input[name=EmployeeNetSalary]').val(empnetsalary);
            $("#lblEmployeeNetSalary").html(empnetsalary);
            var employerPF = Math.round(emppfbasicwages * emplyrpfpercent) || 0;
            $('input[name=EmployerPF]').val(employerPF);
            $("#lblEmployerPF").html(employerPF);
            var employerESIC = 0;
            $('input[name=EmployerESIC]').val(employerESIC);
            $("#lblEmployerESIC").html(employerESIC);

            if(isemppfwages == true && emppfbasicwages == 0)
            {
                $('input[name=EmployerPF]').val(0)
                $("#lblEmployerPF").html(0);
                $('input[name=EmployerESIC]').val(0);
                $("#lblEmployerESIC").html(0);
                employerPF = 0;
                employerESIC = 0;
            }
            if(isemppfwages == true && emppfbasicwages > 0)
            {
                employerPF = Math.round(emppfbasicwages * emplyrpfpercent) || 0;
                $('input[name=EmployerPF]').val(employerPF);
                $("#lblEmployerPF").html(employerPF);
                //employerESIC = Math.round(salary * 0.0325) || 0;
                employerESIC = 0;
                $('input[name=EmployerESIC]').val(employerESIC);
                $("#lblEmployerESIC").html(employerESIC);
            }
            //var employerIns = parseFloat($('input[name=EmployerIns]').val()) || 0;
            var employerIns = ins || 0;
            if(employerIns == 0)
            {
                employerIns = 250
            }
            if(typeofappoint == "Part time")
            {
                //$('input[name=EmpPFBasicWages]').val(0);
                $('input[name=EmployerPF]').val(0)
                $("#lblEmployerPF").html(0);
                $('input[name=EmpPFBasicWages]').attr('readonly',true);
                employerIns = 0;
                employerPF = 0;
            }
            else if(typeofappoint == "Full time")
            {
                $('input[name=EmpPFBasicWages]').removeAttr("readonly");
            }
            $('input[name=EmployerIns]').val(employerIns);
            $("#lblEmployerIns").html(employerIns);
            var ttlemployerContribute = employerPF + employerESIC + employerIns;
            $('input[name=EmployerTtlContribute]').val(ttlemployerContribute);
            $("#lblEmployerTtlContribute").html(ttlemployerContribute);
            var employeeCTC = salary + ttlemployerContribute;
            $('input[name=EmployeeCTC]').val(employeeCTC);
            $("#lblEmployeeCTC").html(employeeCTC);
            //var agencyFee = Math.round(employeeCTC * 0.0194) || 0;
            var agencyFee = Math.round(employeeCTC * agncyfee) || 0;
            $('input[name=AgencyFee]').val(agencyFee);
            $("#lblAgencyFee").html(agencyFee);
            var ctcwithagencyfee = agencyFee + employeeCTC;
            $('input[name=CTCwithAgencyFee]').val(ctcwithagencyfee);
            $("#lblCTCwithAgencyFee").html(ctcwithagencyfee);
            var salaryGST = Math.round(ctcwithagencyfee * gstpercent) || 0;
            $('input[name=SalaryGST]').val(salaryGST);
            $("#lblSalaryGST").html(salaryGST);
            var totalCTC = ctcwithagencyfee + salaryGST;
            $('input[name=TotalCTC]').val(totalCTC);
            $("#lblTotalCTC").html(totalCTC);
        }
        calculatetaxTotal();
        if($('#ArrearOrDeductionTillDate').val() != "") {
            var Arrearamount = calculatetaxTotal(true) || 0;
            $('#ArrearOrDeductionAmount').val(Math.round(Arrearamount));
        }
    });

    }
    $(document).on('click', 'a[class="rct-del-doc"]', function () {
        if (OrderID > 0) {
            var $this = $(this);
            var Filepath = $this.attr("value");
            $(".loading-bg").removeClass('dis-none');
            $.getJSON("@Url.Action("DeleteDocument", "Requirement")", { Appid : ApplicationID, Apptype : typcategory, Doctype : "PI Justification Document", File : Filepath ,Orderid : OrderID},
            function (result) {
                if(result == true)
                {
                    $this.parent('h4').remove();
                    $.alert({
                        title: 'Success Alert!',
                        content: "PI Justification document deleted.",
                        type: 'green'
                    });
                    $(".loading-bg").addClass('dis-none');
                }
                else
                {
                    $.alert({
                        icon: 'ion-close-circled',
                        title: 'Error Alert!',
                        content: "PI Justification document not deleted.",
                        type: 'red'
                    });
                    $(".loading-bg").addClass('dis-none');
                }
            });
        }
    });
</script>
<script src="@Url.Content("~/Content/IOASContent/assets/bootstrap-select/js/bootstrap-select.min.js")"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/FoolProof/mvcfoolproof.unobtrusive.min.js")" type="text/javascript"></script>
