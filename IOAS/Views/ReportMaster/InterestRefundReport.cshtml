@model IOAS.Models.InterestRefundReportModel
@{
    ViewBag.Title = "InterestRefundReport";
    Layout = "~/Views/Shared/_LayoutFluid.cshtml";
}
<div class="row hd-tt-bg">
    <div class="col-md-12">
        <h4><b>Project Interest Report</b> </h4>
    </div>
</div>
<style>
    .vw-dts-bg .hgt-bg {
        background: #597df0;
        color: #fff;
    }

        .vw-dts-bg .hgt-bg label {
            font-size: 16px !important;
            color: #fff !important;
        }

        .vw-dts-bg .hgt-bg h4 {
            font-size: 18px !important;
            color: #fff;
        }

    .vw-dts-bg .hgt-bg-pl {
        background: #e11eda;
        color: #fff;
    }

        .vw-dts-bg .hgt-bg-pl label {
            font-size: 16px !important;
            color: #fff !important;
        }

        .vw-dts-bg .hgt-bg-pl h4 {
            font-size: 18px !important;
            color: #fff;
        }
       
</style>
<div class="row">
@using (Html.BeginForm("InterestRefundReportDetails", "ReportMaster", FormMethod.Post, new { @class = "", role = "form", @id = "formInfReport", enctype = "multipart/form-data" }))
            {
    <div class="white-bg ad-navbar">

        <div class="col-md-3 ds-spl-bg">
            <div class="ds-icn">
                <i class="ion-ios-list-outline "></i>
            </div>
            <div class="ds-tt">
                <span>Project Number</span>
                <input type="text" class="form-control" autocomplete="off" name="ProjNo" id="ProjNo" />
                <input type="text" class="form-control dis-none" autocomplete="off" name="ProjId" id="ProjId" />
            </div>
        </div>
        <div class="col-md-3 ds-spl-bg">
            <div class="ds-tt">
                <span>Financial Year</span>
                @Html.DropDownListFor(m=>m.FinYearId,new SelectList(ViewBag.finyr,"value","label"),"Select FinYear",new {@class="form-control",@id="finYearId",@required="required" })
                <div class="txt-error txt-red">@Html.ValidationMessageFor(M => M.FinYearId)</div>
            </div>
        </div>
        <div class="col-md-3 ds-spl-bg">
            <div class="ds-tt">
                <input type="submit" value="View Report" class="btn btn-primary mt-20" id="btnSubmit" />
            </div>
        </div>

    </div>
    }
</div>
<script>

   $(document).on('click', '#ProjNo', function () {
       applyAutoComplete($('#ProjNo'), $('#ProjId'), '@Url.Action("LoadAllProjectNumber", "CoreAccounts")', undefined, undefined, undefined);
      
   });
    $('#ProjNo').blur(function () {
        var projctId = $('#ProjId').val();
        if(projctId>0)
        {
            loadFinYear(projctId);
        }

    });
    function loadFinYear(projctId) {
        $.getJSON("@Url.Action("GetFinYear", "ReportMaster")", { pId: projctId },
    function (locationdata) {
        var select = $("#finYearId");
        select.empty();
        select.append($('<option/>', {
            value: "",
            text: "Select any"

        }));
        $.each(locationdata, function (index, itemData) {

            select.append($('<option/>', {
                value: itemData.id,
                text: itemData.name

            }));
        });
    });
    }
    $('#btnSubmit').click(function (e) {

        e.preventDefault();
        var isValid = $('#formInfReport').valid();
        if (isValid) {
            var win = window.open('', '_blank');
            var url = "@Url.RouteUrl(new
            { Controller = "ReportMaster", Action = "InterestRefundReportDetails" })?finYearId=" + $('#finYearId').val();
            win.location.href = url + "&projectId=" + $('#ProjId').val();
        }
    });
</script>
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>